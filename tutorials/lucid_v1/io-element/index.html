<!DOCTYPE html>
<html lang="en" dir="auto">
<head>
    
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Io Element</title>


<meta name="keywords" content="keyword1, keyword2, keyword3">



<meta name="description" content="">



<meta name="author" content="Justin Rajewski">


<link rel="canonical" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;lucid_v1&#x2F;io-element&#x2F;">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://alchitry.com/css/styles.css">
<link rel="stylesheet" href="https://alchitry.com/css/override.css">


<link rel="icon" href="https://alchitry.com/favicon.svg" type="image/svg+xml">
<link rel="icon" type="image/png" sizes="16x16" href="https://alchitry.com/favicon_16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://alchitry.com/favicon_32.png">
<link rel="apple-touch-icon" href="https://alchitry.com/apple-touch-icon.png"><!-- 180×180 -->
<meta name="theme-color" content="#333333">


<link rel="alternate" type="application/atom+xml" title="RSS" href="https://alchitry.com/atom.xml">


<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }
    </style>
    
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
    
</noscript>



    
</head>
<body class=" dark" id="top">
    
    
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0"/>

<header class="header">

    <nav class="nav">
        <div class="logo">
            <a href="https:&#x2F;&#x2F;alchitry.com" accesskey="h" title="Alchitry (Alt + H)"><img src="https://alchitry.com/alchitry.svg"
                                                         alt="Alchitry"
                                                         aria-label="Alchitry">
            </a>
        </div>
        
        <div id="nav-search">
            <ul id="menu" class="desktop-nav">
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;shop.alchitry.com&#x2F;collections&#x2F;products" title="Boards">
                        <span>Boards</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;news" title="News">
                        <span>News</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials" title="Tutorials">
                        <span>Tutorials</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;alchitry-labs" title="Alchitry Labs">
                        <span>Alchitry Labs</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;forum.alchitry.com" title="Forum">
                        <span>Forum</span>
                        
                    </a>
                </li>
                
            </ul>
            <div class="search-container">
                <input class="search" type="search" placeholder="Search" autocomplete="off">
                <span class="material-symbols-outlined search-icon">search</span>

                <div class="search-results">
                    <div class="search-results__items"></div>
                </div>
            </div>
        </div>
        <div id="overlayNavOpen">
            <span onclick="openNav()" class="material-symbols-outlined">menu</span>
        </div>
        
    </nav>
</header>


<div id="overlayNav" class="overlay">
    <div class="overlay-header">
        <div class="search-container">
            <input class="search" type="search" placeholder="Search" autocomplete="off">
            <span class="material-symbols-outlined search-icon">search</span>

            <div class="search-results">
                <div class="search-results__items"></div>
            </div>
        </div>
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    </div>

    <div class="overlay-content">
        
        
        
        <a href="https:&#x2F;&#x2F;shop.alchitry.com&#x2F;collections&#x2F;products" title="Boards">
            <span>Boards</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;news" title="News">
            <span>News</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials" title="Tutorials">
            <span>Tutorials</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;alchitry-labs" title="Alchitry Labs">
            <span>Alchitry Labs</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;forum.alchitry.com" title="Forum">
            <span>Forum</span>
            
        </a>
        
    </div>
</div>

    
    <main class="main">
        
<article class="post-single">
    <header class="post-header">
        <div class="breadcrumbs">
            
            <div class="breadcrumb-container">
                <a class="breadcrumb-path" href="/">Home</a>
                
                
                
                
                
                <span class="breadcrumb-separator">»</span>
                
                <a class="breadcrumb-path" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;">Tutorials</a>
                
                
                <span class="breadcrumb-separator">»</span>
                
                <a class="breadcrumb-path" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;lucid_v1&#x2F;">Lucid V1</a>
                
                <span class="breadcrumb-separator">»</span>
                <a class="breadcrumb-path active" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;lucid_v1&#x2F;io-element&#x2F;">Io Element</a>
            </div>
            
        </div>
        <h1 class="post-title">Io Element</h1>
        
        
        <div class="post-meta">
            













42 min&nbsp;·&nbsp;Justin Rajewski

            &nbsp;|&nbsp;&nbsp;<a href="https:&#x2F;&#x2F;github.com&#x2F;alchitry&#x2F;alchitry.github.io&#x2F;tree&#x2F;master/content/tutorials&#x2F;lucid_v1&#x2F;io-element.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

        </div>
        
    </header>

    
    

<div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner">
            <ul>
                
                <li>
                    <a href="#create-the-project" aria-label="Create the Project">Create the Project</a>
                    
                    <ul>
                    
                        <li>
                            <a href="#faking-pull-downs-on-the-cu" aria-label="Faking Pull-downs on the Cu">Faking Pull-downs on the Cu</a>
                            
                        </li>
                    
                    </ul>
                    
                </li>
                
                <li>
                    <a href="#logic-gates" aria-label="Logic Gates">Logic Gates</a>
                    
                </li>
                
                <li>
                    <a href="#bit-wise" aria-label="Bit-wise">Bit-wise</a>
                    
                </li>
                
                <li>
                    <a href="#reduction-operators" aria-label="Reduction Operators">Reduction Operators</a>
                    
                </li>
                
                <li>
                    <a href="#math" aria-label="Math">Math</a>
                    
                </li>
                
                <li>
                    <a href="#seven-segment-displays" aria-label="Seven-Segment Displays">Seven-Segment Displays</a>
                    
                </li>
                
                <li>
                    <a href="#indexing-segments" aria-label="Indexing Segments">Indexing Segments</a>
                    
                </li>
                
                <li>
                    <a href="#getting-fancy-with-numbers" aria-label="Getting Fancy With Numbers">Getting Fancy With Numbers</a>
                    
                </li>
                
                <li>
                    <a href="#decimal-counters" aria-label="Decimal Counters">Decimal Counters</a>
                    
                </li>
                
            </ul>
        </div>
    </details>
</div>


    

    
    <div class="post-content">
        <p>This tutorial will introduce the <a href="https://alchitry.com/boards/io/">Io Element</a> and walk through some basic examples to get your feet wet. If you haven't already, I highly recommend reading through the <a href="https://alchitry.com/tutorials/lucid_v1/your-first-fpga-project/">Your First FPGA Project</a> and <a href="https://alchitry.com/tutorials/lucid_v1/synchronous-logic/">synchronous logic</a> tutorials before continuing.</p>
<h2 id="create-the-project">Create the Project</h2>
<p>In Alchitry Labs, open the new project dialog (File-&gt;New Project...) and name it whatever you want. I named mine <em>Io Element Demo</em>. Before you click <em>Create</em>, select <em>IO Element Base</em> from the <em>From Example</em> drop-down menu. This will give you a bare bones base to start working with the element.</p>
<p>The only difference between this project and the standard base project is that this has the connections to the Io Element already defined for you.</p>
<p>Let's take a look at the top file. You can use the tabs to select the version for your board.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-1"><input
name="tab-group-1"
type="radio"
id="tab-group-1-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-1-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-1-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-1-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-1-0_Au-panel"
	aria-labelledby="tab-group-1-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#faac1f;">module</span><span> au_top </span><span style="color:#ed4343;">(
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> clk</span><span style="color:#ed4343;">,              </span><span style="color:#969696;">// 100MHz clock
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> rst_n</span><span style="color:#ed4343;">,            </span><span style="color:#969696;">// reset button (active low)
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> led </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">],         </span><span style="color:#969696;">// 8 user controllable LEDs
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> usb_rx</span><span style="color:#ed4343;">,           </span><span style="color:#969696;">// USB-&gt;Serial input
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> usb_tx</span><span style="color:#ed4343;">,          </span><span style="color:#969696;">// USB-&gt;Serial output
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> io_led </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">],   </span><span style="color:#969696;">// LEDs on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> io_seg </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">],      </span><span style="color:#969696;">// 7-segment LEDs on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> io_sel </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">],      </span><span style="color:#969696;">// Digit select on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> io_button </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">],    </span><span style="color:#969696;">// 5 buttons on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> io_dip </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">]     </span><span style="color:#969696;">// DIP switches on IO Shield
</span><span>  </span><span style="color:#ed4343;">) {
</span><span>   
</span><span>  </span><span style="color:#0a8dbf;">sig</span><span> rst</span><span style="color:#ed4343;">;                  </span><span style="color:#969696;">// reset signal
</span><span>   
</span><span>  .clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>    </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>    </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>    reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>  </span><span style="color:#ed4343;">}
</span><span>   
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>    reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>    rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>    usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>    led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>    io_led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">x{{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}};    </span><span style="color:#969696;">// turn LEDs off
</span><span>    io_seg </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8hff</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// turn segments off
</span><span>    io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4hf</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// select no digits
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-1"
type="radio"
id="tab-group-1-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-1-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-1-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-1-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-1-1_Cu-panel"
	aria-labelledby="tab-group-1-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#faac1f;">module</span><span> cu_top </span><span style="color:#ed4343;">(
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> clk</span><span style="color:#ed4343;">,              </span><span style="color:#969696;">// 100MHz clock
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> rst_n</span><span style="color:#ed4343;">,            </span><span style="color:#969696;">// reset button (active low)
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> led </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">],         </span><span style="color:#969696;">// 8 user controllable LEDs
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> usb_rx</span><span style="color:#ed4343;">,           </span><span style="color:#969696;">// USB-&gt;Serial input
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> usb_tx</span><span style="color:#ed4343;">,          </span><span style="color:#969696;">// USB-&gt;Serial output
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> io_led </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">],   </span><span style="color:#969696;">// LEDs on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> io_seg </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">],      </span><span style="color:#969696;">// 7-segment LEDs on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> io_sel </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">],      </span><span style="color:#969696;">// Digit select on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">inout</span><span> io_button </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">],    </span><span style="color:#969696;">// 5 buttons on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">inout</span><span> io_dip </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">]     </span><span style="color:#969696;">// DIP switches on IO Shield
</span><span>  </span><span style="color:#ed4343;">) {
</span><span>   
</span><span>  </span><span style="color:#0a8dbf;">sig</span><span> rst</span><span style="color:#ed4343;">;                  </span><span style="color:#969696;">// reset signal
</span><span>   
</span><span>  .clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>    </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>    </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>    reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>    pull_down button_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_button</span><span style="color:#ed4343;">));
</span><span>    pull_down_2d dip_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">DIM_1</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIM_2</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_dip</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span>   
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>    reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>    rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>    usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>    led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>    io_led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">x{{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}};    </span><span style="color:#969696;">// turn LEDs off
</span><span>    io_seg </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8hff</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// turn segments off
</span><span>    io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4hf</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// select no digits
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-1"
type="radio"
id="tab-group-1-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-1-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-1-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-1-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-1-2_Mojo-panel"
	aria-labelledby="tab-group-1-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#faac1f;">module</span><span> mojo_top </span><span style="color:#ed4343;">(
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> clk</span><span style="color:#ed4343;">,              </span><span style="color:#969696;">// 50MHz clock
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> rst_n</span><span style="color:#ed4343;">,            </span><span style="color:#969696;">// reset button (active low)
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> led </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">],         </span><span style="color:#969696;">// 8 user controllable LEDs
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> cclk</span><span style="color:#ed4343;">,             </span><span style="color:#969696;">// configuration clock, AVR ready when high
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> spi_miso</span><span style="color:#ed4343;">,        </span><span style="color:#969696;">// AVR SPI MISO
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> spi_ss</span><span style="color:#ed4343;">,           </span><span style="color:#969696;">// AVR SPI Slave Select
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> spi_mosi</span><span style="color:#ed4343;">,         </span><span style="color:#969696;">// AVR SPI MOSI
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> spi_sck</span><span style="color:#ed4343;">,          </span><span style="color:#969696;">// AVR SPI Clock
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> spi_channel </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">], </span><span style="color:#969696;">// AVR general purpose pins (used by default to select ADC channel)
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> avr_tx</span><span style="color:#ed4343;">,           </span><span style="color:#969696;">// AVR TX (FPGA RX)
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> avr_rx</span><span style="color:#ed4343;">,          </span><span style="color:#969696;">// AVR RX (FPGA TX)
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> avr_rx_busy</span><span style="color:#ed4343;">,      </span><span style="color:#969696;">// AVR RX buffer full
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> io_led </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">],   </span><span style="color:#969696;">// LEDs on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> io_seg </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">],      </span><span style="color:#969696;">// 7-segment LEDs on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> io_sel </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">],      </span><span style="color:#969696;">// Digit select on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> io_button </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">],    </span><span style="color:#969696;">// 5 buttons on IO Shield
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> io_dip </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">]     </span><span style="color:#969696;">// DIP switches on IO Shield
</span><span>  </span><span style="color:#ed4343;">) {
</span><span>   
</span><span>  </span><span style="color:#0a8dbf;">sig</span><span> rst</span><span style="color:#ed4343;">;                  </span><span style="color:#969696;">// reset signal
</span><span>   
</span><span>  .clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>    </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>    </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>    reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>  </span><span style="color:#ed4343;">}
</span><span>   
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>    reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>    rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>    led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>    spi_miso </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// not using SPI
</span><span>    spi_channel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bzzzz</span><span style="color:#ed4343;">;    </span><span style="color:#969696;">// not using flags
</span><span>    avr_rx </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;            </span><span style="color:#969696;">// not using serial port
</span><span>     
</span><span>    io_led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">x{{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}};    </span><span style="color:#969696;">// turn LEDs off
</span><span>    io_seg </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8hff</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// turn segments off
</span><span>    io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4hf</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// select no digits
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p>You can see we have a handful of inputs and outputs named <code class ="language-lucid" data-lang="lucid"><span>io_</span><span style="color:#ed4343;">*</span></code>. These are the Io Element specific signals.</p>
<p><code class ="language-lucid" data-lang="lucid"><span>io_led</span></code> connects to the 24 LEDs. This signal is organized as a 2D array to make it easier to access the three groups of 8 LEDs. For example, if you want to get the first group of LEDs you would use <code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span></code> and if you wanted to get the third LED in the first group, you would use <code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">]</span></code>.</p>
<p>Because <code class ="language-lucid" data-lang="lucid"><span>io_led</span></code> is a 2D array, when we set all the LEDs to 0, we have a little fancy syntax.</p>
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">x{{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}};    </span><span style="color:#969696;">// turn LEDs off
</span></code></pre>
<p>We need the dimensions of our constant to match <code class ="language-lucid" data-lang="lucid"><span>io_led</span></code>. In this case, <code class ="language-lucid" data-lang="lucid"><span>io_led</span></code> is a 3 by 8 array. We use <code class ="language-lucid" data-lang="lucid"><span style="color:#a269dc;">8h00</span></code> as the base constant which is a single dimensional array of width 8. The <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">x{}</span></code> syntax takes the outermost dimension and duplicates it. If we wrote <code class ="language-lucid" data-lang="lucid"><span style="color:#a269dc;">3</span><span style="color:#ed4343;">x{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}</span></code>, we would end up with <code class ="language-lucid" data-lang="lucid"><span style="color:#a269dc;">24h000000</span></code> since the outer most dimension is 8. This isn't what we want as it is still a 1D array. Instead, we need to first create a 1 by 8 array and duplicate it three times. To do this we use the array building syntax, <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">{}</span></code>. The value <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}</span></code> is a 1 by 8 2D array. We then use <code class ="language-lucid" data-lang="lucid"><span style="color:#a269dc;">3</span><span style="color:#ed4343;">x{{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}}</span></code> to get a 3 by 8 array of all zeros. Note that we could have also written <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}</span></code>, but the duplication syntax is a bit cleaner.</p>
<p><code class ="language-lucid" data-lang="lucid"><span>io_seg</span></code> and <code class ="language-lucid" data-lang="lucid"><span>io_sel</span></code> are used to control the 4 seven-segment LED displays. They are active low (0 = on, 1 = off) and they will be covered in more detail later.</p>
<p><code class ="language-lucid" data-lang="lucid"><span>io_button</span></code> is simply the 5 push buttons. <code class ="language-lucid" data-lang="lucid"><span>io_button</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span></code> is up, <code class ="language-lucid" data-lang="lucid"><span>io_button</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">]</span></code> is center, <code class ="language-lucid" data-lang="lucid"><span>io_button</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">]</span></code> is down, <code class ="language-lucid" data-lang="lucid"><span>io_button</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">]</span></code> is left, and <code class ="language-lucid" data-lang="lucid"><span>io_button</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">]</span></code> is right.</p>
<p>Finally, <code class ="language-lucid" data-lang="lucid"><span>io_dip</span></code> is the 24 DIP switches. This is arranged in a 2D array exactly the same way as <code class ="language-lucid" data-lang="lucid"><span>io_led</span></code>.</p>
<h3 id="faking-pull-downs-on-the-cu">Faking Pull-downs on the Cu</h3>
<p>If you are using a Cu then you may have noticed your top module looks a little different than the Au. There are two modules, <code class ="language-lucid" data-lang="lucid"><span>pull_down</span></code> and <code class ="language-lucid" data-lang="lucid"><span>pull_down_2d</span><span style="color:#ed4343;">,</span></code> instantiated and the <code class ="language-lucid" data-lang="lucid"><span>io_button</span></code> and <code class ="language-lucid" data-lang="lucid"><span>io_dip</span></code> signals are of type <code class ="language-lucid" data-lang="lucid"><span style="color:#0a8dbf;">inout</span></code> not <code class ="language-lucid" data-lang="lucid"><span style="color:#0a8dbf;">input</span></code>.</p>
<p>These module fakes pull-down resistors on the DIP switches and buttons by pulling the pin low for a very short amount of time, releasing it, waiting a short period, then sampling the input. </p>
<p>This is done because the Io Element was originally designed to use the pull-down resistors embedded in the FPGA. However, the FPGA on the Cu only has internal pull-up resistors.</p>
<p>If you take a look at the <a href="https://cdn.alchitry.com/boards/alchitry_io_sch.pdf">schematic</a>, you'll see that the buttons and DIP switches are connected to +3.3V via a 330 ohm resistor. This will prevent any damage to the FPGA if the button or DIP switch is active and it tries to pull the pin to 0V.</p>
<p>This method of faking the pull-down resistor works because there is some amount of capacitance on each input pin. Some of it is internal to the FPGA and some is from the board. When the switch isn't active, the pin is normally floating (not being pulled to specific voltage). The FPGA the forces it to 0V and releases it. Since nothing is trying to move it, the only sources to change the voltage are small amounts of leakage in the FPGA and noise. These both take much longer than a couple clock cycles (30ns) to significantly affect it. Therefore, when we read the state of the pin right after pulling it down, it will still be 0 if nothing tried to change it.</p>
<p>If the button or switch is active, when the FPGA pulls the pin down, it will still get it down. This is thanks to that resistor. However, once the FPGA lets go of the pin, the parasitic capacitance will start to charge. We found it takes about 10ns-20ns for it to reach a '1' state (3.3V) after letting go. This is why we wait for 30ns before sampling the pin.</p>
<p>By repeating this process over and over, we can simulate having a normal pull-down resistor.</p>
<p>Thanks to this module, you can ignore that any of this is even happening and simply use its output as you would the input with a pull-down.</p>
<p>The only difference is instead of using <code class ="language-lucid" data-lang="lucid"><span>io_dip</span></code> or <code class ="language-lucid" data-lang="lucid"><span>io_button</span></code> you use <code class ="language-lucid" data-lang="lucid"><span>dip_pd.out</span></code> and <code class ="language-lucid" data-lang="lucid"><span>button_pd.out</span></code> respectively.</p>
<h2 id="logic-gates">Logic Gates</h2>
<p>The first example we will work though is connecting a few DIP switches to the LEDs through logic gates. If you aren't familiar with what logic gates (AND, OR, NOT, XOR) are, you should take a look at the <a href="https://alchitry.com/tutorials/background/digital-logic/">digital logic tutorial</a>.</p>
<p>In this example we are going to start by making the first LED light up when switch 0 <strong>and</strong> 1 are turned on.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-2"><input
name="tab-group-2"
type="radio"
id="tab-group-2-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-2-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-2-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-2-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-2-0_Au-panel"
	aria-labelledby="tab-group-2-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">x{{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}};    </span><span style="color:#969696;">// turn LEDs off
</span><span>  io_seg </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8hff</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// turn segments off
</span><span>  io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4hf</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// select no digits
</span><span>     
</span><span>  io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">];
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-2"
type="radio"
id="tab-group-2-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-2-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-2-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-2-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-2-1_Cu-panel"
	aria-labelledby="tab-group-2-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">x{{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}};    </span><span style="color:#969696;">// turn LEDs off
</span><span>  io_seg </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8hff</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// turn segments off
</span><span>  io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4hf</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// select no digits
</span><span>     
</span><span>  io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">];
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-2"
type="radio"
id="tab-group-2-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-2-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-2-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-2-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-2-2_Mojo-panel"
	aria-labelledby="tab-group-2-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>  spi_miso </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// not using SPI
</span><span>  spi_channel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bzzzz</span><span style="color:#ed4343;">;    </span><span style="color:#969696;">// not using flags
</span><span>  avr_rx </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;            </span><span style="color:#969696;">// not using serial port
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">x{{</span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">}};    </span><span style="color:#969696;">// turn LEDs off
</span><span>  io_seg </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8hff</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// turn segments off
</span><span>  io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4hf</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// select no digits
</span><span>     
</span><span>  io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">];
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p>Take a look at the last line. First we need to index the first LED. The first LED is in the first group (group 0) and is the first in its group, so we used the index <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span></code>. We then index the first and second switches in the same manner. Finally, we use the <strong>&amp;</strong> operator to <strong>AND</strong> the bits together. <strong>&amp;</strong> is the bit-wise AND operator.</p>
<blockquote>
<p>Note that for the Cu this line will look a little different since you need to use the output from the pulldown modules.</p>
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">];
</span></code></pre>
</blockquote>
<p>Notice that I didn't change the line where we assigned all LEDs a value of 0. This is because the assignment to the first LED will simply be overruled by our second assignment. It's good to remember that while <code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always</span></code> blocks have a sequential order of precedence, they aren't actually sequential. This means that <code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span></code> will <strong>only</strong> have the value of the second assignment and it as if the first assignment never happened. The tools will simply wire an AND gate to the two switch inputs and the led output.</p>
<p>Go ahead and build/load the project onto your board. Try playing with the first two switches. If either switch is off, the LED should be off. Only when both switches are on should the LED turn on.</p>
<p>You can now go back and replace the <strong>&amp;</strong> operator with the operators for OR, <strong>|</strong>, XOR, <strong>^</strong>, and XNOR, <strong>~^</strong>. Play with the switches and make sure you understand the different operators.</p>
<p><strong>Practice:</strong> Add two more lines to the <code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always</span></code> block so that the first LED of the first group lights up as before, the first LED of the second group lights up when either (OR) of the first two switches in the second group are on, and the first LED of the last group lights up only when exactly one (XOR) switch of the first two switches in the last group are on.</p>
<h2 id="bit-wise">Bit-wise</h2>
<p>The operators we have talked about so far are all bit-wise operators. That means that they operate on two equally sized arrays and will perform their operation on each pair of bits individually.</p>
<p>For example, if we want to light up the LED in the first group only when the corresponding switch in the first and second groups are both on we could do the following.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-3"><input
name="tab-group-3"
type="radio"
id="tab-group-3-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-3-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-3-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-3-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-3-0_Au-panel"
	aria-labelledby="tab-group-3-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">];
</span></code></pre>
 </div><input
name="tab-group-3"
type="radio"
id="tab-group-3-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-3-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-3-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-3-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-3-1_Cu-panel"
	aria-labelledby="tab-group-3-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">];
</span></code></pre>
 </div><input
name="tab-group-3"
type="radio"
id="tab-group-3-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-3-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-3-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-3-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-3-2_Mojo-panel"
	aria-labelledby="tab-group-3-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">];
</span></code></pre>
 </div>
</div>
<p>Note that <code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span></code> is an array of width 8, and so is <code class ="language-lucid" data-lang="lucid"><span>io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span></code> and <code class ="language-lucid" data-lang="lucid"><span>io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">]</span></code>. This single statement will create 8 individual AND gates.</p>
<p>You can again use the OR, XOR, and XNOR operators in the same way.</p>
<p>We can also chain multiple gates together. For example, what if we want the LED to light only when the corresponding switch in all three groups is on?</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-4"><input
name="tab-group-4"
type="radio"
id="tab-group-4-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-4-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-4-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-4-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-4-0_Au-panel"
	aria-labelledby="tab-group-4-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">];
</span></code></pre>
 </div><input
name="tab-group-4"
type="radio"
id="tab-group-4-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-4-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-4-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-4-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-4-1_Cu-panel"
	aria-labelledby="tab-group-4-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">];
</span></code></pre>
 </div><input
name="tab-group-4"
type="radio"
id="tab-group-4-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-4-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-4-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-4-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-4-2_Mojo-panel"
	aria-labelledby="tab-group-4-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">];
</span></code></pre>
 </div>
</div>
<p>Bit-wise operators are evaluated from left to right so in this case <code class ="language-lucid" data-lang="lucid"><span>io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span></code> will be ANDed with <code class ="language-lucid" data-lang="lucid"><span>io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">]</span></code> and the result will then be ANDed with <code class ="language-lucid" data-lang="lucid"><span>io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">]</span></code>. In the case of AND gates, the order actually doesn't matter. However, if you start mixing and matching operators the order can matter. You can also use parenthesis to make the order you want things evaluated explicit.</p>
<p><strong>Practice:</strong> Use two bit-wise operators so that the LEDs in the first group light up when the corresponding switch in the third group is on or both switches in the first two groups are on.</p>
<h2 id="reduction-operators">Reduction Operators</h2>
<p>Reduction operators are similar to the bit-wise operators but they work on a single input array and always output one bit. You could say they <code class ="language-lucid" data-lang="lucid"><span>reduce</span></code> an array to a single bit. </p>
<p>You can think of these operators as one huge logic gate with many inputs. The number of inputs is equal to the size of the array the operator is used on.</p>
<p>In our example, we want to turn the first LED on only if every switch in the first group is turned on. To do this we can use the <strong>&amp;</strong> reduction operator.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-5"><input
name="tab-group-5"
type="radio"
id="tab-group-5-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-5-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-5-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-5-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-5-0_Au-panel"
	aria-labelledby="tab-group-5-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] = &amp;</span><span>io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">];
</span></code></pre>
 </div><input
name="tab-group-5"
type="radio"
id="tab-group-5-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-5-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-5-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-5-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-5-1_Cu-panel"
	aria-labelledby="tab-group-5-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] = &amp;</span><span>dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">];
</span></code></pre>
 </div><input
name="tab-group-5"
type="radio"
id="tab-group-5-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-5-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-5-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-5-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-5-2_Mojo-panel"
	aria-labelledby="tab-group-5-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] = &amp;</span><span>io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">];
</span></code></pre>
 </div>
</div>
<p>This is equivalent to ANDing each bit individually as shown below.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-6"><input
name="tab-group-6"
type="radio"
id="tab-group-6-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-6-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-6-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-6-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-6-0_Au-panel"
	aria-labelledby="tab-group-6-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">6</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">7</span><span style="color:#ed4343;">];
</span></code></pre>
 </div><input
name="tab-group-6"
type="radio"
id="tab-group-6-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-6-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-6-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-6-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-6-1_Cu-panel"
	aria-labelledby="tab-group-6-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">6</span><span style="color:#ed4343;">] &amp;</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">7</span><span style="color:#ed4343;">];
</span></code></pre>
 </div><input
name="tab-group-6"
type="radio"
id="tab-group-6-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-6-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-6-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-6-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-6-2_Mojo-panel"
	aria-labelledby="tab-group-6-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">6</span><span style="color:#ed4343;">] &amp;</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">7</span><span style="color:#ed4343;">];
</span></code></pre>
 </div>
</div>
<p>However, as you can tell, the reduction operator is much more compact.</p>
<p>It is even possible to use the reduction operators on multi-dimensional arrays. For example, if we want the LED to turn on when <strong>any</strong> switch is on we could use the following.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-7"><input
name="tab-group-7"
type="radio"
id="tab-group-7-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-7-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-7-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-7-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-7-0_Au-panel"
	aria-labelledby="tab-group-7-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] = |</span><span>io_dip</span><span style="color:#ed4343;">; 
</span></code></pre>
 </div><input
name="tab-group-7"
type="radio"
id="tab-group-7-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-7-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-7-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-7-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-7-1_Cu-panel"
	aria-labelledby="tab-group-7-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] = |</span><span>dip_pd.out</span><span style="color:#ed4343;">;
</span></code></pre>
 </div><input
name="tab-group-7"
type="radio"
id="tab-group-7-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-7-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-7-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-7-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-7-2_Mojo-panel"
	aria-labelledby="tab-group-7-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>io_led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] = |</span><span>io_dip</span><span style="color:#ed4343;">; 
</span></code></pre>
 </div>
</div>
<p>I tend to use the AND version to easily detect if a signal is at its maximum value (all 1's). The OR version basically tells you if the value is not 0 and the XOR version will tell you if there is an odd number of 1's.</p>
<p>Each of these operators can also be negated with the bit-wise negate operator, <strong>~</strong>. You can simply place this in front of the expression to get the NAND, NOR, and XNOR equivalents.</p>
<p><strong>Practice:</strong> Using your newly acquired bit-wise and reduction operator skills, make the first LED light up when any switch in the third group is on, or all the switches in the second group are on and the first group has an odd number of switches on. This is a fairly tricky challenge but everything you need has been mentioned in this tutorial. If you get stuck feel free to head over to the <a href="http://forum.alchitry.com/">forum</a> for some help.</p>
<h2 id="math">Math</h2>
<p>This part of the tutorial we will look at addition, subtraction, and multiplication. We will be performing different operations using the DIP switches as our number inputs. This means everything will be in binary, so if you aren't familiar with binary check out the <a href="https://alchitry.com/tutorials/background/encodings/">encodings tutorial</a>.</p>
<p>Let's start with some addition. We will add the binary values from the first and second groups of DIP switches.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-8"><input
name="tab-group-8"
type="radio"
id="tab-group-8-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-8-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-8-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-8-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-8-0_Au-panel"
	aria-labelledby="tab-group-8-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="color:#0a8dbf;">sig</span><span> result </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">];          </span><span style="color:#969696;">// result of our operations
</span><span>   
</span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8hff</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// turn segments off
</span><span>  io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4hf</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// select no digits
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] +</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// add the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-8"
type="radio"
id="tab-group-8-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-8-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-8-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-8-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-8-1_Cu-panel"
	aria-labelledby="tab-group-8-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="color:#0a8dbf;">sig</span><span> result </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">];          </span><span style="color:#969696;">// result of our operations
</span><span>   
</span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8hff</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// turn segments off
</span><span>  io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4hf</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// select no digits
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] +</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// add the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-8"
type="radio"
id="tab-group-8-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-8-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-8-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-8-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-8-2_Mojo-panel"
	aria-labelledby="tab-group-8-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="color:#0a8dbf;">sig</span><span> result </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">];          </span><span style="color:#969696;">// result of our operations
</span><span>   
</span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>  spi_miso </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// not using SPI
</span><span>  spi_channel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bzzzz</span><span style="color:#ed4343;">;    </span><span style="color:#969696;">// not using flags
</span><span>  avr_rx </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;            </span><span style="color:#969696;">// not using serial port
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8hff</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// turn segments off
</span><span>  io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4hf</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// select no digits
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] +</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// add the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p>Because the result of many of our operations will be more than 8 bits, we can create a signal, <code class ="language-lucid" data-lang="lucid"><span>result</span></code>, to hold the value. You can think of signals (<strong>sig</strong>) simply as wires. They don't add any cost to your design as they simply define the connection from something to something else.</p>
<p>We set result to be the output of our addition. The addition of two 8 bit numbers results in a 9 bit result. This is because an 8 bit number has the range 0-255 so adding two of them together will have the range 0-510, which requires 9 bits to represent.</p>
<p>We then take result and connect it to the LEDs so that we can see all 24 bits. However, this requires the use of the helper function <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">()</span></code>. This function takes a 1D array as the first argument and splits it into a multidimensional array. In our case we pass 3 as the second parameter which causes it to split the 24 bits three ways into a 3x8 array.</p>
<p>You can pass <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">()</span></code> more than one dimension to split. For example, <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">)</span></code> would create a 3x2x4 array.</p>
<p>The helper function <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$flatten</span><span style="color:#ed4343;">()</span></code> does the opposite. It takes a multidimensional array and flattens it into a 1D array.</p>
<p>Build and load your project to your board. Congratulations! You've just build a very basic calculator. To make sure everything is working properly, let's calculate 2+2. 2 has the binary representation of 0000 0010. Set both groups of switches to 2. The result on the LEDs should be 4, or 0000 0100.</p>
<p>Now change the <strong>+</strong> to a <strong>-</strong> to subtract the first switch value from the second.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-9"><input
name="tab-group-9"
type="radio"
id="tab-group-9-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-9-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-9-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-9-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-9-0_Au-panel"
	aria-labelledby="tab-group-9-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] -</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// subtract the switch values
</span></code></pre>
 </div><input
name="tab-group-9"
type="radio"
id="tab-group-9-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-9-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-9-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-9-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-9-1_Cu-panel"
	aria-labelledby="tab-group-9-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>result </span><span style="color:#ed4343;">=</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] -</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// subtract the switch values
</span></code></pre>
 </div><input
name="tab-group-9"
type="radio"
id="tab-group-9-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-9-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-9-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-9-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-9-2_Mojo-panel"
	aria-labelledby="tab-group-9-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] -</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// subtract the switch values
</span></code></pre>
 </div>
</div>
<p>What happens when you set the second switch to 0 and the first to 1 so you're performing 0-1? All 24 LEDs turn on! You can interpret this answer in two different ways. The first is that the result simply underflowed and restarted back at the maximum value. The second way is to assume the number is a 2's complement representation of -1. Both are valid interpretations and what you use will depend on the scenario.</p>
<p>Even though when the number is negative all 24 LEDs light up, you only need 9 bits to represent any 8 bit by 8 bit addition or subtraction. This is because when the value would be negative, dropping the leading 1's doesn't change its value.</p>
<p>Finally, change the <strong>-</strong> to ***** to test out multiplication.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-10"><input
name="tab-group-10"
type="radio"
id="tab-group-10-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-10-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-10-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-10-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-10-0_Au-panel"
	aria-labelledby="tab-group-10-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span></code></pre>
 </div><input
name="tab-group-10"
type="radio"
id="tab-group-10-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-10-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-10-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-10-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-10-1_Cu-panel"
	aria-labelledby="tab-group-10-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>result </span><span style="color:#ed4343;">=</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span></code></pre>
 </div><input
name="tab-group-10"
type="radio"
id="tab-group-10-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-10-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-10-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-10-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-10-2_Mojo-panel"
	aria-labelledby="tab-group-10-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span></code></pre>
 </div>
</div>
<p>You should notice that multiplying two numbers can generate a much bigger result than the operands. The result will generally be twice the size of the inputs. So in our case, up to 16 bits wide.</p>
<p>Multiplication is much more expensive to perform than a simple addition or subtraction. This is because a multiplication is essentially many additions. Multiplying two 8 bit numbers will result in a series of eight additions.</p>
<p>Also note that we didn't talk about division. This is because there isn't a division operator. Division is much more complicated than even multiplication and there are some trade offs you need to decide for your design so a default option doesn't make sense. If you don't need real division, you can approximate it by multiplying with fractions.</p>
<p>To approximate division, you can first multiply by any number and then shift the value to the right. Shifting to the right effectively divides by a power of two (rounding down). For example, if you want to divide a number by 3, you could multiply by 85 then shift right 8 bits. This will effectively multiply your value by 85/256 = 0.33203 which is pretty close to 1/3. If you need higher precision, you can use more bits. For example, you could instead multiply by 21845 and shift 16 bits to the right. This is effectively multiplying by 0.333328, but 16 bit multiplication is significantly more expensive than 8 bit.</p>
<h2 id="seven-segment-displays">Seven-Segment Displays</h2>
<p>The Io Element has four seven-segment displays that are multiplexed. This means that we have two groups of signals, the first, <code class ="language-lucid" data-lang="lucid"><span>io_seg</span></code>, connects to the segments of each display.</p>
<p><img src="https://cdn.alchitry.com/lucid_v1/7-seg.png" alt="7-seg.png" /></p>
<p>Note that even though we call these <em>seven</em>-segment displays there are actually 8 LEDs in each one because of the decimal point.</p>
<p>All four displays have all their segments connected together. That means if you apply power to segment 0, all four displays segment 0 receive power! This is done to save on the number of pins required to drive the displays. However, it means that we need a way to disable all but one display so that we can show a unique number on each one.</p>
<p>This is where the second group of signals, <code class ="language-lucid" data-lang="lucid"><span>io_sel</span></code>, comes in handy. These are used to select which digit is active. Typically, only one digit will be active at any time. If you have more than one digit active, all active digits will show exactly the same thing since their segments are wired together.</p>
<p>The way we are going to display four unique numbers is by cycling which digit is active really fast. If we can do this fast enough, our eyes can't tell and it looks like all four digits are always on.</p>
<p>However, before we do that, let's play around with the displays a bit to get familiar with how they work.</p>
<h2 id="indexing-segments">Indexing Segments</h2>
<p>We are going to setup some modules so that we light one segment at a time. To do this we will be using some of the components built into Alchitry Labs.</p>
<p>Click <strong>Project-&gt;Add Components...</strong>. Under <strong>Miscellaneous</strong> check off <em>Counter</em> and <em>Decoder</em>. Click <strong>Add</strong> to add them to your project.</p>
<p>You can now find the source for these components under <strong>Components</strong> in the left project tree in Alchitry Labs. Note that while you are free to look at the source, components are read-only (no editing!). If you ever want to modify a component, simply copy and paste the code into a module of your own.</p>
<p>It's always a good idea to check out the source and read the description of the component. Many components have parameters that you can set to customize them for your use. We'll be doing exactly that with these two.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-11"><input
name="tab-group-11"
type="radio"
id="tab-group-11-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-11-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-11-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-11-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-11-0_Au-panel"
	aria-labelledby="tab-group-11-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">25</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span><span>   
</span><span>decoder num_to_seg </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">));
</span></code></pre>
 </div><input
name="tab-group-11"
type="radio"
id="tab-group-11-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-11-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-11-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-11-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-11-1_Cu-panel"
	aria-labelledby="tab-group-11-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  pull_down button_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_button</span><span style="color:#ed4343;">));
</span><span>  pull_down_2d dip_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">DIM_1</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIM_2</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_dip</span><span style="color:#ed4343;">));
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">25</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span><span>   
</span><span>decoder num_to_seg </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">));
</span></code></pre>
 </div><input
name="tab-group-11"
type="radio"
id="tab-group-11-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-11-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-11-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-11-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-11-2_Mojo-panel"
	aria-labelledby="tab-group-11-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span><span>   
</span><span>decoder num_to_seg </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">));
</span></code></pre>
 </div>
</div>
<p>Here we add the <code class ="language-lucid" data-lang="lucid"><span>counter</span></code> and <code class ="language-lucid" data-lang="lucid"><span>decoder</span></code> modules to the top level module. The <code class ="language-lucid" data-lang="lucid"><span>counter</span></code> component requires both a clock and reset signal so we have it in the nested in both the <code class ="language-lucid" data-lang="lucid"><span>.clk</span></code> and <code class ="language-lucid" data-lang="lucid"><span>.rst</span></code> connection blocks. On the other hand, <code class ="language-lucid" data-lang="lucid"><span>decoder</span></code> doesn't require either, so it is outside of both.</p>
<p>The counter is simply a counter. It will output a value starting from zero and increment to whatever the maximum value you set is. After that it will reset back to zero. It is also possible to configure it to count down from the max value to zero.</p>
<p>The counter has four parameters you can set to get it to operate how you want, but here we only need to change two. <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">SIZE</span></code> dictates how wide the output of the counter is. In this case we need it to count from 0 to 7 for all 8 segments of our displays. Three bits is exactly 0 - 7. If we wanted to count to a value that wasn't conveniently a power of 2 minus one, we could set the parameter <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">TOP</span></code> to control its maximum value.</p>
<p>The <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">DIV</span></code> parameter is used to set how many bits to use to divide the clock. By setting this to 25 (or 24 on the Mojo), the counter will only increment its output every 225, or 33,554,432, clock cycles (16,777,216 on the Mojo). The clock runs at 100MHz (100,000,000 cycles per second) on the Au and Cu and 50MHz (50,000,000 cycles per second) on the Mojo. If the counter incremented every clock cycle it would be way too fast for us to see.</p>
<p>The decoder is a binary to one-hot decoder. If you need a refresher on one-hot representation check out the <a href="https://alchitry.com/tutorials/background/encodings/">encodings tutorial</a>. Basically, the decoder will take our three bits and convert it to eight bits. If the input is 0, then the 0th bit of the output will be 1 and everything else will be 0. If the input is 4, the 4th bit will be 1 and everything else will be 0. This allows us to use the binary counter to light individual LEDs.</p>
<p>Note that the output of the decoder is 2^<em>WIDTH</em> bits wide. So in our case, 2^3 = 8 bits wide.</p>
<p>Now we can hook up the modules.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-12"><input
name="tab-group-12"
type="radio"
id="tab-group-12-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-12-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-12-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-12-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-12-0_Au-panel"
	aria-labelledby="tab-group-12-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  num_to_seg.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;
</span><span>  
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>num_to_seg.out</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect segments to counter
</span><span>  io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4h0</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// select all digits
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-12"
type="radio"
id="tab-group-12-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-12-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-12-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-12-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-12-1_Cu-panel"
	aria-labelledby="tab-group-12-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  num_to_seg.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;
</span><span>  
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>num_to_seg.out</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect segments to counter
</span><span>  io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4h0</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// select all digits
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-12"
type="radio"
id="tab-group-12-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-12-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-12-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-12-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-12-2_Mojo-panel"
	aria-labelledby="tab-group-12-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>  spi_miso </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// not using SPI
</span><span>  spi_channel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bzzzz</span><span style="color:#ed4343;">;    </span><span style="color:#969696;">// not using flags
</span><span>  avr_rx </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;            </span><span style="color:#969696;">// not using serial port
</span><span>     
</span><span>  num_to_seg.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;
</span><span>  
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>num_to_seg.out</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect segments to counter
</span><span>  io_sel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4h0</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// select all digits
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p>We feed the binary counter value into the decoder and the output of the decoder to <code class ="language-lucid" data-lang="lucid"><span>io_seg</span></code>. Note that <code class ="language-lucid" data-lang="lucid"><span>io_seg</span></code> and <code class ="language-lucid" data-lang="lucid"><span>io_sel</span></code> are both <strong>active low</strong>. This means that when the signal is 0, it is active. To turn only one LED on we need to invert the output of the decoder with the bit-wise inversion, <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">~</span></code>, operator. This will make the signal zero-hot.</p>
<p>Also notice we need to set <code class ="language-lucid" data-lang="lucid"><span>io_sel</span></code> to 0 so that the LED segments are selected. Setting all of them to 0 will turn them all on.</p>
<p>Build and load your project to your board. You should now see the segments of all 4 displays lighting one at time. Try to light only a single display by setting <code class ="language-lucid" data-lang="lucid"><span>io_sel</span></code> to <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">~</span><span style="color:#a269dc;">4h1</span></code> instead.</p>
<p>Now what if we wanted to cycle through each digit? We need another counter that increments each time the original counter overflows. That way once each LED of a specific digit is lit, the next digit is selected. However, we don't actually need another counter to do this! We can simply make our existing counter 2 bits wider. By adding extra bits, these will increment only when the lower three bits overflow, creating the behavior we want.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-13"><input
name="tab-group-13"
type="radio"
id="tab-group-13-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-13-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-13-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-13-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-13-0_Au-panel"
	aria-labelledby="tab-group-13-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">25</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span><span>   
</span><span>decoder num_to_seg </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">));
</span><span>decoder num_to_digit </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">));
</span></code></pre>
 </div><input
name="tab-group-13"
type="radio"
id="tab-group-13-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-13-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-13-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-13-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-13-1_Cu-panel"
	aria-labelledby="tab-group-13-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  pull_down button_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_button</span><span style="color:#ed4343;">));
</span><span>  pull_down_2d dip_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">DIM_1</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIM_2</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_dip</span><span style="color:#ed4343;">));
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">25</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span><span>   
</span><span>decoder num_to_seg </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">));
</span><span>decoder num_to_digit </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">));
</span></code></pre>
 </div><input
name="tab-group-13"
type="radio"
id="tab-group-13-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-13-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-13-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-13-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-13-2_Mojo-panel"
	aria-labelledby="tab-group-13-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span><span>   
</span><span>decoder num_to_seg </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">));
</span><span>decoder num_to_digit </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">));
</span></code></pre>
 </div>
</div>
<p>Here we increase the <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">SIZE</span></code> of <code class ="language-lucid" data-lang="lucid"><span>ctr</span></code> to 5. We also add another decoder with <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">WIDTH</span></code> of 2. We need 2 since we have 4 digits to select from and an input of 2 bits gives us possible values of 0-3.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-14"><input
name="tab-group-14"
type="radio"
id="tab-group-14-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-14-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-14-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-14-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-14-0_Au-panel"
	aria-labelledby="tab-group-14-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  num_to_seg.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">];   </span><span style="color:#969696;">// lower three bits used for segments
</span><span>  num_to_digit.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// upper two bits used for digits
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>num_to_seg.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// connect segments to counter
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span>num_to_digit.out</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect digit select to counter
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-14"
type="radio"
id="tab-group-14-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-14-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-14-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-14-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-14-1_Cu-panel"
	aria-labelledby="tab-group-14-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  num_to_seg.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">];   </span><span style="color:#969696;">// lower three bits used for segments
</span><span>  num_to_digit.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// upper two bits used for digits
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>num_to_seg.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// connect segments to counter
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span>num_to_digit.out</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect digit select to counter
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-14"
type="radio"
id="tab-group-14-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-14-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-14-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-14-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-14-2_Mojo-panel"
	aria-labelledby="tab-group-14-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>  spi_miso </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// not using SPI
</span><span>  spi_channel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bzzzz</span><span style="color:#ed4343;">;    </span><span style="color:#969696;">// not using flags
</span><span>  avr_rx </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;            </span><span style="color:#969696;">// not using serial port
</span><span>     
</span><span>  num_to_seg.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">];   </span><span style="color:#969696;">// lower three bits used for segments
</span><span>  num_to_digit.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// upper two bits used for digits
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>num_to_seg.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// connect segments to counter
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span>num_to_digit.out</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect digit select to counter
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p>We can select the lower three bits of <code class ="language-lucid" data-lang="lucid"><span>ctr.value</span></code> by using the bit selector <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">[</span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span></code>. This says we want bits 2 down-to 0 inclusive. We can do the same thing for the upper two bits.</p>
<p>Build and load your project again. This time you should see only one digit and one segment lit at any time. Once each segment of a digit has been lit, the next digit is selected.</p>
<p>You may have also noticed that the segments are now much brighter. This is because the resistor that is in-line with the LEDs is sized for a single LED, not all four. When you have all four on at the same time, the current is split between them making them all dimmer.</p>
<h2 id="getting-fancy-with-numbers">Getting Fancy With Numbers</h2>
<p>Lighting up the segments is super cool and all, but it's much cooler to actually show some numbers.</p>
<p>Before we jump into multiplexing, we need a way to convert a number into the segments that need to be lit to represent that number. To do this we can use a look-up table.</p>
<p>Create a new module called <code class ="language-lucid" data-lang="lucid"><span>seven_seg</span></code> and add the following.</p>
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#faac1f;">module</span><span> seven_seg </span><span style="color:#ed4343;">(
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> char</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">],
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> segs</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">7</span><span style="color:#ed4343;">]
</span><span>  </span><span style="color:#ed4343;">) {
</span><span> 
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>    </span><span style="font-weight:bold;color:#0abfbf;">case </span><span style="color:#ed4343;">(</span><span>char</span><span style="color:#ed4343;">) {
</span><span>      </span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b0111111</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b0000110</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#a269dc;">2</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b1011011</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b1001111</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b1100110</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b1101101</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#a269dc;">6</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b1111101</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#a269dc;">7</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b0000111</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b1111111</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#a269dc;">9</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b1100111</span><span style="color:#ed4343;">;
</span><span>      </span><span style="color:#0abfbf;">default</span><span style="color:#ed4343;">:</span><span> segs </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">7b0000000</span><span style="color:#ed4343;">;
</span><span>    </span><span style="color:#ed4343;">}
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
<p>This module will take a binary number, <code class ="language-lucid" data-lang="lucid"><span>char</span></code>, and output the segments, <code class ="language-lucid" data-lang="lucid"><span>segs</span></code>, that need to be on.</p>
<p>This module uses a <strong>case</strong> statement. Case statements are equivalent to a bunch of <code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">if</span></code> statements. One of the entries will be selected based on the value of <code class ="language-lucid" data-lang="lucid"><span>char</span></code>. If <code class ="language-lucid" data-lang="lucid"><span>char</span></code> is 1, then only the block after the <code class ="language-lucid" data-lang="lucid"><span style="color:#a269dc;">1</span><span style="color:#ed4343;">:</span></code> is used. If none of the blocks match, the <code class ="language-lucid" data-lang="lucid"><span style="color:#0abfbf;">default</span><span style="color:#ed4343;">:</span></code> block is used. The default block is optional, but it is generally a good idea to include it even if you think you have all the cases covered.</p>
<p>If <code class ="language-lucid" data-lang="lucid"><span>char</span></code> is an invalid number (not 0-9), then all the segments will be off.</p>
<p>To test out our look-up table, let's connect it to our counter.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-15"><input
name="tab-group-15"
type="radio"
id="tab-group-15-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-15-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-15-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-15-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-15-0_Au-panel"
	aria-labelledby="tab-group-15-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">TOP</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">9</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">25</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span><span>   
</span><span>seven_seg seg</span><span style="color:#ed4343;">;
</span></code></pre>
 </div><input
name="tab-group-15"
type="radio"
id="tab-group-15-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-15-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-15-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-15-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-15-1_Cu-panel"
	aria-labelledby="tab-group-15-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  pull_down button_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_button</span><span style="color:#ed4343;">));
</span><span>  pull_down_2d dip_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">DIM_1</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIM_2</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_dip</span><span style="color:#ed4343;">));
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">TOP</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">9</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">25</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span><span>   
</span><span>seven_seg seg</span><span style="color:#ed4343;">;
</span></code></pre>
 </div><input
name="tab-group-15"
type="radio"
id="tab-group-15-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-15-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-15-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-15-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-15-2_Mojo-panel"
	aria-labelledby="tab-group-15-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">TOP</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">9</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span><span>   
</span><span>seven_seg seg</span><span style="color:#ed4343;">;
</span></code></pre>
 </div>
</div>
<p>We need <code class ="language-lucid" data-lang="lucid"><span>ctr</span></code> to count from 0-9 so we set <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">TOP</span></code> to 9 to cap its value. Also, we need to change <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">SIZE</span></code> to 4, as we only need 4 bits to represent 0-9.</p>
<p>Because we don't need the decoders anymore, we can remove them and add our <code class ="language-lucid" data-lang="lucid"><span>seven_seg</span></code> module.</p>
<p>Finally, we need to wire it up the LEDs</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-16"><input
name="tab-group-16"
type="radio"
id="tab-group-16-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-16-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-16-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-16-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-16-0_Au-panel"
	aria-labelledby="tab-group-16-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  seg.char </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>seg.segs</span><span style="color:#ed4343;">;     </span><span style="color:#969696;">// connect segments to counter
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span style="color:#a269dc;">4h1</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// first digit only
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-16"
type="radio"
id="tab-group-16-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-16-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-16-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-16-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-16-1_Cu-panel"
	aria-labelledby="tab-group-16-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  seg.char </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>seg.segs</span><span style="color:#ed4343;">;     </span><span style="color:#969696;">// connect segments to counter
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span style="color:#a269dc;">4h1</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// first digit only
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-16"
type="radio"
id="tab-group-16-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-16-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-16-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-16-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-16-2_Mojo-panel"
	aria-labelledby="tab-group-16-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>  spi_miso </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// not using SPI
</span><span>  spi_channel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bzzzz</span><span style="color:#ed4343;">;    </span><span style="color:#969696;">// not using flags
</span><span>  avr_rx </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;            </span><span style="color:#969696;">// not using serial port
</span><span>     
</span><span>  seg.char </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>seg.segs</span><span style="color:#ed4343;">;     </span><span style="color:#969696;">// connect segments to counter
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span style="color:#a269dc;">4h1</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// first digit only
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p><code class ="language-lucid" data-lang="lucid"><span>io_sel</span></code> is set to <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">~</span><span style="color:#a269dc;">4h1</span></code> so that only the right most digit is on.</p>
<p>Build and load the project onto your board to make sure the first digit is correctly counting from 0 to 9.</p>
<p>Now we need to make a module that will take four values in and display them on all four digits instead of only using one.</p>
<p>Create a new module called <code class ="language-lucid" data-lang="lucid"><span>multi_seven_seg</span></code> and add the following code.</p>
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#faac1f;">module</span><span> multi_seven_seg </span><span style="color:#ed4343;">#(
</span><span>    </span><span style="color:#d45ada;">DIGITS </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4 </span><span style="color:#ed4343;">: </span><span style="color:#d45ada;">DIGITS </span><span style="color:#ed4343;">&gt; </span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#d45ada;">DIV </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">16 </span><span style="color:#ed4343;">: </span><span style="color:#d45ada;">DIV </span><span style="color:#ed4343;">&gt;= </span><span style="color:#a269dc;">0
</span><span>  </span><span style="color:#ed4343;">)(
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> clk</span><span style="color:#ed4343;">,                </span><span style="color:#969696;">// clock
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> rst</span><span style="color:#ed4343;">,                </span><span style="color:#969696;">// reset
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> values </span><span style="color:#ed4343;">[</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">], </span><span style="color:#969696;">// values to show
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> seg </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">7</span><span style="color:#ed4343;">],           </span><span style="color:#969696;">// LED segments
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> sel </span><span style="color:#ed4343;">[</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">]       </span><span style="color:#969696;">// Digit select
</span><span>  </span><span style="color:#ed4343;">) {
</span><span> 
</span><span>  </span><span style="color:#969696;">// number of bits required to store DIGITS-1
</span><span>  </span><span style="color:#0a8dbf;">const </span><span style="color:#d45ada;">DIGIT_BITS </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$clog2</span><span style="color:#ed4343;">(</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">);
</span><span> 
</span><span>  .clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">),</span><span> .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#d45ada;">DIGIT_BITS</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">TOP</span><span style="color:#ed4343;">(</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">-</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">)); 
</span><span>  </span><span style="color:#ed4343;">}
</span><span> 
</span><span>  seven_seg seg_dec</span><span style="color:#ed4343;">;                      </span><span style="color:#969696;">// segment decoder
</span><span>  decoder digit_dec </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">WIDTH</span><span style="color:#ed4343;">(</span><span style="color:#d45ada;">DIGIT_BITS</span><span style="color:#ed4343;">)); </span><span style="color:#969696;">// digit decoder
</span><span> 
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>    seg_dec.char </span><span style="color:#ed4343;">=</span><span> values</span><span style="color:#ed4343;">[</span><span>ctr.value</span><span style="color:#ed4343;">];     </span><span style="color:#969696;">// select the value for the active digit
</span><span>    seg </span><span style="color:#ed4343;">=</span><span> seg_dec.segs</span><span style="color:#ed4343;">;                   </span><span style="color:#969696;">// output the decoded value
</span><span> 
</span><span>    digit_dec.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// decode active digit to one-hot
</span><span>    sel </span><span style="color:#ed4343;">=</span><span> digit_dec.out</span><span style="color:#ed4343;">;                  </span><span style="color:#969696;">// output the active digit
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
<p>This module is parameterized so that it could be used to drive more or less than 4 digits, but the defaults are set to work well with our project.</p>
<p>The constant <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">DIGIT_BITS</span></code> is the number of bits we need to cover all <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">DIGITS</span></code> number of digits. We use the function <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$clog2</span><span style="color:#ed4343;">()</span></code> which computes the ceiling log base 2 of a constant value.</p>
<p>We only want the counter to count from 0 to <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">-</span><span style="color:#a269dc;">1</span></code> so we set the <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">TOP</span></code> parameter accordingly.</p>
<p><code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">DIV</span></code> is used so that we don't switch between the digits too fast. If we switch too fast, the transistors that drive the LEDs don't have time to fully turn off, and we get bleed between digits.</p>
<p>The way this module works is <code class ="language-lucid" data-lang="lucid"><span>ctr</span></code> is used to select the active digit. The value from <code class ="language-lucid" data-lang="lucid"><span>values</span></code> is then selected, decoded, and sent to the segments of the LEDs displays. The binary value of the active digit is then decoded into a one-hot value as before and used to select which digit is on. Because <code class ="language-lucid" data-lang="lucid"><span>ctr</span></code> keeps cycling the active digits, all the displays will appear on.</p>
<p>We can tweak <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">DIV</span></code>, but if it is set too high, we will start to see the digits flicker. If it is set too low, we will see bleeding between digits.</p>
<p>Let's test out this module by feeding it some constant numbers to show.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-17"><input
name="tab-group-17"
type="radio"
id="tab-group-17-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-17-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-17-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-17-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-17-0_Au-panel"
	aria-labelledby="tab-group-17-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    multi_seven_seg seg</span><span style="color:#ed4343;">;
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-17"
type="radio"
id="tab-group-17-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-17-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-17-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-17-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-17-1_Cu-panel"
	aria-labelledby="tab-group-17-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  pull_down button_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_button</span><span style="color:#ed4343;">));
</span><span>  pull_down_2d dip_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">DIM_1</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIM_2</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_dip</span><span style="color:#ed4343;">));
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    multi_seven_seg seg</span><span style="color:#ed4343;">;
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-17"
type="radio"
id="tab-group-17-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-17-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-17-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-17-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-17-2_Mojo-panel"
	aria-labelledby="tab-group-17-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    multi_seven_seg seg</span><span style="color:#ed4343;">;
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p>We don't need the counter or the seven_seg modules from before, but we need the <code class ="language-lucid" data-lang="lucid"><span>multi_seven_seg</span></code> now.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-18"><input
name="tab-group-18"
type="radio"
id="tab-group-18-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-18-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-18-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-18-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-18-0_Au-panel"
	aria-labelledby="tab-group-18-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  seg.values </span><span style="color:#ed4343;">= {</span><span style="color:#a269dc;">4h8</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">4h5</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">4h3</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">4h1</span><span style="color:#ed4343;">};
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>seg.seg</span><span style="color:#ed4343;">;      </span><span style="color:#969696;">// connect segments to the driver
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span>seg.sel</span><span style="color:#ed4343;">;      </span><span style="color:#969696;">// connect digit select to the driver
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-18"
type="radio"
id="tab-group-18-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-18-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-18-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-18-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-18-1_Cu-panel"
	aria-labelledby="tab-group-18-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  seg.values </span><span style="color:#ed4343;">= {</span><span style="color:#a269dc;">4h8</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">4h5</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">4h3</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">4h1</span><span style="color:#ed4343;">};
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>seg.seg</span><span style="color:#ed4343;">;      </span><span style="color:#969696;">// connect segments to the driver
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span>seg.sel</span><span style="color:#ed4343;">;      </span><span style="color:#969696;">// connect digit select to the driver
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-18"
type="radio"
id="tab-group-18-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-18-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-18-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-18-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-18-2_Mojo-panel"
	aria-labelledby="tab-group-18-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>  spi_miso </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// not using SPI
</span><span>  spi_channel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bzzzz</span><span style="color:#ed4343;">;    </span><span style="color:#969696;">// not using flags
</span><span>  avr_rx </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;            </span><span style="color:#969696;">// not using serial port
</span><span>     
</span><span>  seg.values </span><span style="color:#ed4343;">= {</span><span style="color:#a269dc;">4h8</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">4h5</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">4h3</span><span style="color:#ed4343;">,</span><span style="color:#a269dc;">4h1</span><span style="color:#ed4343;">};
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>seg.seg</span><span style="color:#ed4343;">;      </span><span style="color:#969696;">// connect segments to the driver
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span>seg.sel</span><span style="color:#ed4343;">;      </span><span style="color:#969696;">// connect digit select to the driver
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p>On the line starting with <code class ="language-lucid" data-lang="lucid"><span>seg.values</span></code>, we feed the values to display into the driver.</p>
<p>Build and load the design to your Mojo to make sure each digit is displaying the correct number.</p>
<h2 id="decimal-counters">Decimal Counters</h2>
<p>Alright, now that we have a way to show a value on our display, let's make the display count! For this we need a decimal counter. We could use a regular counter and convert the binary value into four decimal values, but that's a bit trickier. Instead, we will create a special counter that counts in base 10.</p>
<p>To do this we will create two modules. The first will be a single digit counter and the second will chain these together for a multi-digit counter.</p>
<p>Create a new module called <code class ="language-lucid" data-lang="lucid"><span>decimal_counter</span></code> with the following code.</p>
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#faac1f;">module</span><span> decimal_counter </span><span style="color:#ed4343;">(
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> clk</span><span style="color:#ed4343;">,      </span><span style="color:#969696;">// clock
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> rst</span><span style="color:#ed4343;">,      </span><span style="color:#969696;">// reset
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> inc</span><span style="color:#ed4343;">,      </span><span style="color:#969696;">// increment the counter
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> ovf</span><span style="color:#ed4343;">,     </span><span style="color:#969696;">// counter overflowed
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> value</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">] </span><span style="color:#969696;">// current value
</span><span>  </span><span style="color:#ed4343;">) {
</span><span> 
</span><span>  .clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">),</span><span> .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    </span><span style="color:#0a8dbf;">dff</span><span> val</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">];     </span><span style="color:#969696;">// value storage
</span><span>  </span><span style="color:#ed4343;">}
</span><span> 
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>    value </span><span style="color:#ed4343;">=</span><span> val.q</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// output the value
</span><span> 
</span><span>    ovf </span><span style="color:#ed4343;">=</span><span> val.q </span><span style="color:#ed4343;">== </span><span style="color:#a269dc;">9 </span><span style="color:#ed4343;">&amp;&amp;</span><span> inc</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// if max value and incrementing, overflow!
</span><span> 
</span><span>    </span><span style="font-weight:bold;color:#0abfbf;">if </span><span style="color:#ed4343;">(</span><span>inc</span><span style="color:#ed4343;">) {               </span><span style="color:#969696;">// should add 1
</span><span>      </span><span style="font-weight:bold;color:#0abfbf;">if </span><span style="color:#ed4343;">(</span><span>val.q </span><span style="color:#ed4343;">== </span><span style="color:#a269dc;">9</span><span style="color:#ed4343;">)        </span><span style="color:#969696;">// if max value
</span><span>        val.d </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">;           </span><span style="color:#969696;">// reset to 0
</span><span>      </span><span style="font-weight:bold;color:#0abfbf;">else                   </span><span style="color:#969696;">// otherwise
</span><span>        val.d </span><span style="color:#ed4343;">=</span><span> val.q </span><span style="color:#ed4343;">+ </span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// add one
</span><span>    </span><span style="color:#ed4343;">}
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
<p>Our decimal counter has an input <code class ="language-lucid" data-lang="lucid"><span>inc</span></code> that is used to signal when the value should be increased. When the digit is about to overflow to 0, the flag <code class ="language-lucid" data-lang="lucid"><span>ovf</span></code> is set to 1. The current value of the counter is output on <code class ="language-lucid" data-lang="lucid"><span>value</span></code>.</p>
<p>We now need to chain these together to make a multi-digit counter.</p>
<p>Create a new module named <code class ="language-lucid" data-lang="lucid"><span>multi_dec_ctr</span></code> and add the following code.</p>
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#faac1f;">module</span><span> multi_dec_ctr </span><span style="color:#ed4343;">#(
</span><span>    </span><span style="color:#d45ada;">DIGITS </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4 </span><span style="color:#ed4343;">: </span><span style="color:#d45ada;">DIGITS </span><span style="color:#ed4343;">&gt;= </span><span style="color:#a269dc;">2  </span><span style="color:#969696;">// number of digits
</span><span>  </span><span style="color:#ed4343;">) (
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> clk</span><span style="color:#ed4343;">,                </span><span style="color:#969696;">// clock
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> rst</span><span style="color:#ed4343;">,                </span><span style="color:#969696;">// reset
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> inc</span><span style="color:#ed4343;">,                </span><span style="color:#969696;">// increment counter
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> digits</span><span style="color:#ed4343;">[</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">][</span><span style="color:#a269dc;">4</span><span style="color:#ed4343;">]  </span><span style="color:#969696;">// digit values
</span><span>  </span><span style="color:#ed4343;">) {
</span><span> 
</span><span>  .clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">),</span><span> .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    decimal_counter dctr </span><span style="color:#ed4343;">[</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// digit counters
</span><span>  </span><span style="color:#ed4343;">}
</span><span> 
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>    dctr.inc</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">] =</span><span> inc</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// increment the first digit
</span><span>    digits </span><span style="color:#ed4343;">=</span><span> dctr.value</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// output the values
</span><span> 
</span><span>    </span><span style="color:#969696;">// if the previous digit overflows, increment the next
</span><span>    dctr.inc</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">+:</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">-</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] =</span><span> dctr.ovf</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">+:</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">-</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">];
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
<p>Here we take <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">DIGITS</span></code> <code class ="language-lucid" data-lang="lucid"><span>decimal_counter</span></code> modules and chain them together. Each counter <code class ="language-lucid" data-lang="lucid"><span>inc</span></code> signal is connected to the previous counter's <em>ovf</em> signal. This means that once a counter overflows from 9 to 0, the next one will be incremented. Of course, the first counter doesn't have a previous counter's <code class ="language-lucid" data-lang="lucid"><span>ovf</span></code> signal, so we use an external increment signal instead.</p>
<p>We use the bit selectors <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">+:</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">-</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">]</span></code> and <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">+:</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">-</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">]</span></code> to select bits from <code class ="language-lucid" data-lang="lucid"><span>dctr.inc</span></code> and <code class ="language-lucid" data-lang="lucid"><span>dctr.ovf</span></code>. What <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">+:</span><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">-</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">]</span></code> means is starting from bit 1, select <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">DIGITS</span><span style="color:#ed4343;">-</span><span style="color:#a269dc;">1</span></code> bits going up. This is an easy way to select a specified number of bits given some start index. You can use <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">-:</span></code> instead of <code class ="language-lucid" data-lang="lucid"><span style="color:#ed4343;">+:</span></code> to select bits going down from the given start index instead of going up.</p>
<p>All that is left now is to generate the <code class ="language-lucid" data-lang="lucid"><span>inc</span></code> signal and connect the counter to our display driver.</p>
<p>The <code class ="language-lucid" data-lang="lucid"><span>inc</span></code> signal needs to be a pulse that stays high for only one clock cycle every time we want to increment our counter. To create this we are going to use the counter component as before, but there is a problem with this. If we create a counter that only outputs one bit, the bit will be high for have of the time and not just one cycle at a time. To fix this we will use another component, the <em>Edge Detector</em>.</p>
<p>Go into the component selector and add the <em>Edge Detector</em> to your project. You can find it under <strong>Miscellaneous</strong>.</p>
<p>This component takes a signal and sends out a pulse when it detects a rising, falling, or either type of edge. You can configure which edges you care about.</p>
<p>Let's add all the modules to <code class ="language-lucid" data-lang="lucid"><span>mojo_top</span></code>.</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-19"><input
name="tab-group-19"
type="radio"
id="tab-group-19-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-19-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-19-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-19-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-19-0_Au-panel"
	aria-labelledby="tab-group-19-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  edge_detector edge_detector </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">RISE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">FALL</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">));
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    multi_seven_seg seg</span><span style="color:#ed4343;">;
</span><span>    multi_dec_ctr dec_ctr</span><span style="color:#ed4343;">;
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-19"
type="radio"
id="tab-group-19-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-19-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-19-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-19-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-19-1_Cu-panel"
	aria-labelledby="tab-group-19-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  pull_down button_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">5</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_button</span><span style="color:#ed4343;">));
</span><span>  pull_down_2d dip_pd </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">DIM_1</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIM_2</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">),</span><span> .in</span><span style="color:#ed4343;">(</span><span>io_dip</span><span style="color:#ed4343;">));
</span><span>     
</span><span>  edge_detector edge_detector </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">RISE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">FALL</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">));
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    multi_seven_seg seg</span><span style="color:#ed4343;">;
</span><span>    multi_dec_ctr dec_ctr</span><span style="color:#ed4343;">;
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-19"
type="radio"
id="tab-group-19-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-19-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-19-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-19-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-19-2_Mojo-panel"
	aria-labelledby="tab-group-19-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">) {
</span><span>  </span><span style="color:#969696;">// The reset conditioner is used to synchronize the reset signal to the FPGA
</span><span>  </span><span style="color:#969696;">// clock. This ensures the entire FPGA comes out of reset at the same time.
</span><span>  reset_conditioner reset_cond</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  edge_detector edge_detector </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">RISE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">FALL</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">));
</span><span>     
</span><span>  .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) {
</span><span>    multi_seven_seg seg</span><span style="color:#ed4343;">;
</span><span>    multi_dec_ctr dec_ctr</span><span style="color:#ed4343;">;
</span><span>    counter ctr </span><span style="color:#ed4343;">(#</span><span style="color:#d45ada;">SIZE</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">), #</span><span style="color:#d45ada;">DIV</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">));
</span><span>  </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p>For the edge detector, we set <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">RISE</span></code> to 1 and <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">FALL</span></code> to 0. This means we will generate a pulse only on rising edges.</p>
<p>We now have the multi-digit driver, the multi-digit counter, and a way to generate a pulse from the counter.</p>
<p>Let's wire them all up!</p>
<div class="md-fenced-code-tabs" id="tab-tab-group-20"><input
name="tab-group-20"
type="radio"
id="tab-group-20-0_Au"
checked="checked"
class="code-tab"
data-lang="Au"
aria-controls="tab-group-20-0_Au-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-20-0_Au"
class="code-tab-label"
data-lang="Au"
id="tab-group-20-0_Au-label"
>Au</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Au"
	id="tab-group-20-0_Au-panel"
	aria-labelledby="tab-group-20-0_Au-label"
> <pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  edge_detector.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;
</span><span>  dec_ctr.inc </span><span style="color:#ed4343;">=</span><span> edge_detector.out</span><span style="color:#ed4343;">;
</span><span>  seg.values </span><span style="color:#ed4343;">=</span><span> dec_ctr.digits</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>seg.seg</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect segments to the driver
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span>seg.sel</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect digit select to the driver
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-20"
type="radio"
id="tab-group-20-1_Cu"
class="code-tab"
data-lang="Cu"
aria-controls="tab-group-20-1_Cu-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-20-1_Cu"
class="code-tab-label"
data-lang="Cu"
id="tab-group-20-1_Cu-label"
>Cu</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Cu"
	id="tab-group-20-1_Cu-panel"
	aria-labelledby="tab-group-20-1_Cu-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  usb_tx </span><span style="color:#ed4343;">=</span><span> usb_rx</span><span style="color:#ed4343;">;        </span><span style="color:#969696;">// loop serial port
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>     
</span><span>  edge_detector.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;
</span><span>  dec_ctr.inc </span><span style="color:#ed4343;">=</span><span> edge_detector.out</span><span style="color:#ed4343;">;
</span><span>  seg.values </span><span style="color:#ed4343;">=</span><span> dec_ctr.digits</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>seg.seg</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect segments to the driver
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span>seg.sel</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect digit select to the driver
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> dip_pd.out</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div><input
name="tab-group-20"
type="radio"
id="tab-group-20-2_Mojo"
class="code-tab"
data-lang="Mojo"
aria-controls="tab-group-20-2_Mojo-panel"
aria-hidden="true"
role="tab"
>
<label
for="tab-group-20-2_Mojo"
class="code-tab-label"
data-lang="Mojo"
id="tab-group-20-2_Mojo-label"
>Mojo</label>
<div
	class="code-tabpanel"
	role="tabpanel"
	data-lang="Mojo"
	id="tab-group-20-2_Mojo-panel"
	aria-labelledby="tab-group-20-2_Mojo-label"
> 
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>  reset_cond.in </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// input raw inverted reset signal
</span><span>  rst </span><span style="color:#ed4343;">=</span><span> reset_cond.out</span><span style="color:#ed4343;">;   </span><span style="color:#969696;">// conditioned reset
</span><span>     
</span><span>  led </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">8h00</span><span style="color:#ed4343;">;             </span><span style="color:#969696;">// turn LEDs off
</span><span>  spi_miso </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;          </span><span style="color:#969696;">// not using SPI
</span><span>  spi_channel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bzzzz</span><span style="color:#ed4343;">;    </span><span style="color:#969696;">// not using flags
</span><span>  avr_rx </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">bz</span><span style="color:#ed4343;">;            </span><span style="color:#969696;">// not using serial port
</span><span>     
</span><span>  edge_detector.in </span><span style="color:#ed4343;">=</span><span> ctr.value</span><span style="color:#ed4343;">;
</span><span>  dec_ctr.inc </span><span style="color:#ed4343;">=</span><span> edge_detector.out</span><span style="color:#ed4343;">;
</span><span>  seg.values </span><span style="color:#ed4343;">=</span><span> dec_ctr.digits</span><span style="color:#ed4343;">;
</span><span>     
</span><span>  io_seg </span><span style="color:#ed4343;">= ~</span><span>seg.seg</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect segments to the driver
</span><span>  io_sel </span><span style="color:#ed4343;">= ~</span><span>seg.sel</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// connect digit select to the driver
</span><span>     
</span><span>  result </span><span style="color:#ed4343;">=</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] *</span><span> io_dip</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]; </span><span style="color:#969696;">// multiply the switch values
</span><span>     
</span><span>  io_led </span><span style="color:#ed4343;">= </span><span style="color:#1bddaf;">$build</span><span style="color:#ed4343;">(</span><span>result</span><span style="color:#ed4343;">, </span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">); </span><span style="color:#969696;">// convert result from a 24-bit array to a 3x8 array
</span><span style="color:#ed4343;">}
</span></code></pre>
 </div>
</div>
<p>The value from the counter is fed into the edge detector. The pulse from the edge detector is fed into the decimal counter. The decimals from the decimal counter are sent to the multi-digit driver. Finally, the multi-digit driver is connected to the actual display.</p>
<p>This is what is so cool about FPGAs. Each one of these modules operates completely independently of one another since they all exist in hardware!</p>
<p>This example is fairly complicated, but by breaking down the problem in little chunks (modules) we were able to create a design that is relatively easy to understand and flexible for future upgrades.</p>
<p>Now for the moment of truth, build and load the project onto your board! With any luck, you should see the seven-segment display counting!</p>
<p>If you want to make it count slower or faster you can mess with <code class ="language-lucid" data-lang="lucid"><span>ctr</span></code>'s <code class ="language-lucid" data-lang="lucid"><span style="color:#d45ada;">DIV</span></code> value.</p>

    </div>
    

    <footer class="post-footer">
        

        
        



<nav class="paginav">
    
        
        <a class="prev" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;lucid_v1&#x2F;synchronous-logic&#x2F;">
            <span class="title">« Prev</span>
            <br>
            <span>Synchronous Logic</span>
        </a>
        
        
        <a class="next" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;lucid_v1&#x2F;components&#x2F;">
            <span class="title">Next »</span>
            <br>
            <span>Components</span>
        </a>
        
    
</nav>


        
        
    </footer>

</article>

    </main>
    
    <footer class="footer">
    <div>
        <div class="social-icons">
    
    <a href="https:&#x2F;&#x2F;github.com&#x2F;alchitry" target="_blank" rel="noopener noreferrer me" title="GitHub">
        

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>


    </a>
    
    <a href="https:&#x2F;&#x2F;youtube.com&#x2F;c&#x2F;alchitry" target="_blank" rel="noopener noreferrer me" title="YouTube">
        

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z">
    </path>
    <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
</svg>


    </a>
    
    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;atom.xml" target="_blank" rel="noopener noreferrer me" title="RSS">
        

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>


    </a>
    
</div>

        <span>&copy; 2025 <a href="https:&#x2F;&#x2F;alchitry.com">Alchitry</a></span>
    </div>
</footer>


<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z"/>
    </svg>
</a>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>


<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>


<script>
    /* Open */
    function openNav() {
        document.getElementById("overlayNav").style.display = "block";
    }

    /* Close */
    function closeNav() {
        document.getElementById("overlayNav").style.display = "none";
    }
</script>



<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {
            }
            ;
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            // td containing LineNos
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            // table containing LineNos and code
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            // code blocks not having highlight as parent class
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript" src="https://alchitry.com/elasticlunr.min.js"></script>
<script type="text/javascript" src="https://alchitry.com/search.js"></script>
    
</body>
</html>
