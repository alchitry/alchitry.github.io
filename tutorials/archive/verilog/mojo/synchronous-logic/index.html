<!DOCTYPE html>
<html lang="en" dir="auto">
<head>
    
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Synchronous Logic</title>


<meta name="keywords" content="keyword1, keyword2, keyword3">



<meta name="description" content="">



<meta name="author" content="Justin Rajewski">


<link rel="canonical" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;archive&#x2F;verilog&#x2F;mojo&#x2F;synchronous-logic&#x2F;">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<script type="importmap">
    {
      "imports": {
        "@material/web/": "https://esm.run/@material/web/"
      }
    }
</script>
<script type="module">
    import '@material/web/all.js';
    import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
</script>

<link rel="stylesheet" href="https://alchitry.com/styles.css">
<link rel="stylesheet" href="https://alchitry.com/override.css">

<link rel="icon" href="https://alchitry.com/favicon.svg" type="image/svg+xml">
<link rel="icon" type="image/png" sizes="16x16" href="https://alchitry.com/favicon_16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://alchitry.com/favicon_32.png">
<link rel="apple-touch-icon" href="https://alchitry.com/apple-touch-icon.png"><!-- 180×180 -->
<meta name="theme-color" content="#333333">


<link rel="alternate" type="application/atom+xml" title="RSS" href="https://alchitry.com/atom.xml">


<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }
    </style>
    
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
    
</noscript>



    
</head>
<body class=" dark" id="top">
    
    
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0"/>

<header class="header">

    <nav class="nav">
        <div class="logo">
            <a href="https:&#x2F;&#x2F;alchitry.com" accesskey="h" title="Alchitry (Alt + H)"><img src="https://alchitry.com/alchitry.svg"
                                                         alt="Alchitry"
                                                         aria-label="Alchitry">
            </a>
        </div>
        
        <div id="nav-search">
            <ul id="menu" class="desktop-nav">
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;shop.alchitry.com&#x2F;collections&#x2F;products" title="Boards">
                        <span>Boards</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;news" title="News">
                        <span>News</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials" title="Tutorials">
                        <span>Tutorials</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;alchitry-labs" title="Alchitry Labs">
                        <span>Alchitry Labs</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;forum.alchitry.com" title="Forum">
                        <span>Forum</span>
                        
                    </a>
                </li>
                
            </ul>
            <div class="search-container">
                <input class="search" type="search" placeholder="Search" autocomplete="off">
                <span class="material-symbols-outlined search-icon">search</span>

                <div class="search-results">
                    <div class="search-results__items"></div>
                </div>
            </div>
        </div>
        <div id="overlayNavOpen">
            <span onclick="openNav()" class="material-symbols-outlined">menu</span>
        </div>
        
    </nav>
</header>


<div id="overlayNav" class="overlay">
    <div class="overlay-header">
        <div class="search-container">
            <input class="search" type="search" placeholder="Search" autocomplete="off">
            <span class="material-symbols-outlined search-icon">search</span>

            <div class="search-results">
                <div class="search-results__items"></div>
            </div>
        </div>
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    </div>

    <div class="overlay-content">
        
        
        
        <a href="https:&#x2F;&#x2F;shop.alchitry.com&#x2F;collections&#x2F;products" title="Boards">
            <span>Boards</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;news" title="News">
            <span>News</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials" title="Tutorials">
            <span>Tutorials</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;alchitry-labs" title="Alchitry Labs">
            <span>Alchitry Labs</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;forum.alchitry.com" title="Forum">
            <span>Forum</span>
            
        </a>
        
    </div>
</div>

    
    <main class="main">
        
<article class="post-single">
    <header class="post-header">
        <div class="breadcrumbs">
            
            <div class="breadcrumb-container">
                <a class="breadcrumb-path" href="/">Home</a>
                
                
                
                
                
                <span class="breadcrumb-separator">»</span>
                
                <a class="breadcrumb-path" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;">Tutorials</a>
                
                
                <span class="breadcrumb-separator">»</span>
                
                <a class="breadcrumb-path" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;archive&#x2F;">Archive</a>
                
                
                <span class="breadcrumb-separator">»</span>
                
                <a class="breadcrumb-path" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;archive&#x2F;verilog&#x2F;">Verilog</a>
                
                
                <span class="breadcrumb-separator">»</span>
                
                <a class="breadcrumb-path" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;archive&#x2F;verilog&#x2F;mojo&#x2F;">Mojo</a>
                
                <span class="breadcrumb-separator">»</span>
                <a class="breadcrumb-path active" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;archive&#x2F;verilog&#x2F;mojo&#x2F;synchronous-logic&#x2F;">Synchronous Logic</a>
            </div>
            
        </div>
        <h1 class="post-title">Synchronous Logic</h1>
        
        
        <div class="post-meta">
            













12 min&nbsp;·&nbsp;Justin Rajewski

            &nbsp;|&nbsp;&nbsp;<a href="https:&#x2F;&#x2F;github.com&#x2F;alchitry&#x2F;alchitry.github.io&#x2F;tree&#x2F;master/content/tutorials&#x2F;archive&#x2F;verilog&#x2F;mojo&#x2F;synchronous-logic.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

        </div>
        
    </header>

    
    

<div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner">
            <ul>
                
                <li>
                    <a href="#the-problem" aria-label="The Problem">The Problem</a>
                    
                </li>
                
                <li>
                    <a href="#clocks" aria-label="Clocks">Clocks</a>
                    
                </li>
                
                <li>
                    <a href="#d-flip-flops" aria-label="D Flip-Flops">D Flip-Flops</a>
                    
                </li>
                
                <li>
                    <a href="#loops" aria-label="Loops">Loops</a>
                    
                </li>
                
                <li>
                    <a href="#creating-the-blinker-module" aria-label="Creating the blinker module">Creating the blinker module</a>
                    
                </li>
                
                <li>
                    <a href="#the-reg" aria-label="The reg">The reg</a>
                    
                </li>
                
                <li>
                    <a href="#combinational-always-blocks" aria-label="Combinational always blocks">Combinational always blocks</a>
                    
                </li>
                
                <li>
                    <a href="#synchronous-always-blocks" aria-label="Synchronous always blocks">Synchronous always blocks</a>
                    
                </li>
                
                <li>
                    <a href="#the-counter" aria-label="The counter">The counter</a>
                    
                </li>
                
                <li>
                    <a href="#non-blocking-assignments" aria-label="Non-blocking assignments">Non-blocking assignments</a>
                    
                </li>
                
                <li>
                    <a href="#instantiating-a-module" aria-label="Instantiating a module">Instantiating a module</a>
                    
                </li>
                
            </ul>
        </div>
    </details>
</div>


    

    
    <div class="post-content">
        <div class="video-container">
    <iframe class="video" src="https://www.youtube.com/embed/kOE1GXge11k?si=nZOT0nboMJxjkcVl"
            title="YouTube video player" frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
</div>
<p>Synchronous logic if a fundamental building block for just about any digital design. It allows you to create much more complex systems that accomplish something over a series of steps. It also gives you the ability to save states or other information. In this tutorial you will be introduced to the <strong>D flip flop</strong> and how you can use these to make an LED blink.</p>
<h3 id="the-problem">The Problem</h3>
<p>In our last tutorial we simply wired a LED to a button. Whenever you pressed the button the LED would turn on. Our design had no concept of time. The goal for this project is to blink an LED. That means we have to create a circuit that can turn itself on and off automatically after a regular interval of time has passed. For this we need the flip flop.</p>
<h3 id="clocks">Clocks</h3>
<p>Before I can explain what exactly a flip flop does you need to understand what a clock is.</p>
<p>A clock is just a signal that toggles between 0 and 1 over and over again. It looks something like this.</p>
<p><img src="https://cdn.alchitry.com/verilog/mojo/clock.png" alt="" /></p>
<p>The important thing is the rate at which it toggles. The clock on the Mojo is a 50MHz clock. That means that it toggles 50 million times per second!</p>
<p>The clock has two edges, the <strong>rising edge</strong> and the <strong>falling edge</strong>. I drew the rising edges with little arrows. The rising edge is usually the important one.</p>
<h3 id="d-flip-flops">D Flip-Flops</h3>
<p>This is one of the most important circuit elements you will be using. Lucky for you, it is also fairly straight forward how they work. Take a look at the symbol for the flip flop below.</p>
<p><img src="https://cdn.alchitry.com/verilog/mojo/dff.png" alt="dff.png" /></p>
<p>This image shows all the signals that a flip flop could have, but in practice, the only required signals are <strong>D</strong>, <strong>Q</strong>, and <strong>clk</strong>. For now, forget about <strong>rst</strong> and <strong>en</strong>.</p>
<p>So what exactly does this thing do? All it does is copy the signal at <strong>D</strong> to <strong>Q</strong> whenever there is a rising edge on the <strong>clk</strong> input. That means <strong>Q</strong> will keep it's value between rising edges of the clock. Since the flip flop <em>remembers</em> what the input was at <strong>D</strong>, it is actually one of the most basic memory elements. </p>
<h3 id="loops">Loops</h3>
<p>Lets take a look at the following example.</p>
<p><img src="https://cdn.alchitry.com/verilog/mojo/notloop.png" alt="notloop.png" /></p>
<p>What will this circuit do? If the input to the gate is 1, then it's output is 0. However, the output is the input so the output must be 1, but then the input is 1 so the output must be 0? If we assume that the signal can only be 0 or 1 it seems like it would toggle between 0 and 1 infinitely fast. In practice, remember that signals are actually represented by voltages, it may oscillate or it may settle to somewhere in the middle. This is of course something we don't want! Designing combinational circuits with feedback can be very tricky to make sure something like this doesn't happen and that the circuit will work how you expect it to. That is why we don't! Instead, we use a circuit like this one.</p>
<p><img src="https://cdn.alchitry.com/verilog/mojo/dffnot.png" alt="dffnot.png" /></p>
<p>What will this circuit do? Well, for now lets just assume that <strong>Q</strong> is 0. That means that <strong>D</strong> is 1 (because it went through the not gate). On the next rising edge of the clock <strong>Q</strong> will copy what <strong>D</strong> is, so <strong>Q</strong> becomes 1. Once <strong>Q</strong> becomes 1, <strong>D</strong> becomes 0! You can follow the pattern to realize that every time there is a rising edge on the clock the output of the flip flop toggles.</p>
<p>What about the initial condition though? If we just built this circuit how do we know if <strong>Q</strong> is 0 or 1? The truth is that we don't and in some cases it may be 1 while others it may be 0. That is where the <strong>rst</strong> signal comes in. This signal is used to reset the flip flop to a known state. In FPGAs this signal is generally very flexible and allows you to reset the flip flop to a 1 or 0 when the signal is high or low (your choice, not both). I personally like to use an <strong>active high</strong> reset. That means when the <strong>rst</strong> signal is 1, the flip flop is held in reset.</p>
<p>There are cases where you don't care what the inital value of the flip flop is, in those cases you don't need to, and shouldn't, use a reset.</p>
<p>Since the only signal left is <strong>en</strong>, I'll cover it now just for completeness. There are times when you want the flip flop to ignore the rising edges on the clock and to preserve the contents of <strong>Q</strong>. That is when you use the <strong>enable</strong> signal. When the <strong>en</strong> signal is 1, the flip flop operates normally. When it is 0 the contents of <strong>Q</strong> won't change on the rising edges of the clock. If you see a flip flop without an <strong>en</strong> signal it is just assumed that the flip flop is always enabled.</p>
<h3 id="creating-the-blinker-module">Creating the blinker module</h3>
<p>We are going to modify the code from the previous tutorial to create the blinker, so make sure you've downloaded <a href="https://github.com/embmicro/mojo-base-project/archive/master.zip">the base project</a>. </p>
<p>Open up the project in ISE. We now are going to add a new module which will be our blinker. On the left in the <strong>Hierarchy</strong> section right click on <strong>mojo_top</strong> and choose <strong>New Source...</strong>. </p>
<p><img src="https://cdn.alchitry.com/verilog/mojo/addfile.png" alt="addfile.png" /></p>
<p>Select <strong>Verilog Module</strong> and enter <strong>blinker.v</strong> as the name. Click <strong>Next</strong> then <strong>Next</strong> then <strong>Finish</strong>.</p>
<p>The file should open in the editor. Replace the existing code with the following.</p>
<pre data-linenos data-lang="verilog" style="background-color:#282828;color:#ffffff;" class="language-verilog "><code class ="language-verilog" data-lang="verilog"><table><tbody><tr><td>1</td><td><span style="font-weight:bold;color:#faac1f;">module</span><span> blinker</span><span style="color:#ed4343;">(
</span></td></tr><tr><td>2</td><td><span>    </span><span style="color:#0a8dbf;">input</span><span> clk</span><span style="color:#ed4343;">,
</span></td></tr><tr><td>3</td><td><span>    </span><span style="color:#0a8dbf;">input</span><span> rst</span><span style="color:#ed4343;">,
</span></td></tr><tr><td>4</td><td><span>    </span><span style="color:#0a8dbf;">output</span><span> blink
</span></td></tr><tr><td>5</td><td><span>  </span><span style="color:#ed4343;">);
</span></td></tr><tr><td>6</td><td><span> 
</span></td></tr><tr><td>7</td><td><span>  </span><span style="color:#0a8dbf;">reg </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span><span> counter_d</span><span style="color:#ed4343;">,</span><span> counter_q</span><span style="color:#ed4343;">;
</span></td></tr><tr><td>8</td><td><span> 
</span></td></tr><tr><td>9</td><td><span>  </span><span style="font-weight:bold;color:#0abfbf;">assign</span><span> blink </span><span style="color:#ed4343;">=</span><span> counter_q</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">];
</span></td></tr><tr><td>10</td><td><span> 
</span></td></tr><tr><td>11</td><td><span>  </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">@(</span><span>counter_q</span><span style="color:#ed4343;">) </span><span style="font-weight:bold;color:#0abfbf;">begin
</span></td></tr><tr><td>12</td><td><span>    counter_d </span><span style="color:#ed4343;">=</span><span> counter_q </span><span style="color:#ed4343;">+ </span><span style="color:#a269dc;">1&#39;b1</span><span style="color:#ed4343;">;
</span></td></tr><tr><td>13</td><td><span>  </span><span style="font-weight:bold;color:#0abfbf;">end
</span></td></tr><tr><td>14</td><td><span> 
</span></td></tr><tr><td>15</td><td><span>  </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">@(</span><span style="font-weight:bold;color:#0abfbf;">posedge</span><span> clk</span><span style="color:#ed4343;">) </span><span style="font-weight:bold;color:#0abfbf;">begin
</span></td></tr><tr><td>16</td><td><span>    </span><span style="font-weight:bold;color:#0abfbf;">if </span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) </span><span style="font-weight:bold;color:#0abfbf;">begin
</span></td></tr><tr><td>17</td><td><span>      counter_q </span><span style="color:#ed4343;">&lt;= </span><span style="color:#a269dc;">25&#39;b0</span><span style="color:#ed4343;">;
</span></td></tr><tr><td>18</td><td><span>    </span><span style="font-weight:bold;color:#0abfbf;">end else begin
</span></td></tr><tr><td>19</td><td><span>      counter_q </span><span style="color:#ed4343;">&lt;=</span><span> counter_d</span><span style="color:#ed4343;">;
</span></td></tr><tr><td>20</td><td><span>    </span><span style="font-weight:bold;color:#0abfbf;">end
</span></td></tr><tr><td>21</td><td><span>  </span><span style="font-weight:bold;color:#0abfbf;">end
</span></td></tr><tr><td>22</td><td><span> 
</span></td></tr><tr><td>23</td><td><span style="font-weight:bold;color:#faac1f;">endmodule
</span></td></tr></tbody></table></code></pre>
<p>Just like the last tutorial lets break down the code to understand what is going one.</p>
<h3 id="the-reg">The reg</h3>
<pre data-linenos data-lang="verilog" style="background-color:#282828;color:#ffffff;" class="language-verilog "><code class ="language-verilog" data-lang="verilog"><table><tbody><tr><td>7</td><td><span style="color:#0a8dbf;">reg </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">24</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span><span> counter_d</span><span style="color:#ed4343;">,</span><span> counter_q</span><span style="color:#ed4343;">;
</span></td></tr></tbody></table></code></pre>
<p>This is the first new piece of code. Reg stands for register, and is a bit different than a wire. Flip flops are sometimes called registers. However, a confusing thing in Verilog is that a reg does not necessarily become a flip flop and they can be used in ways similar to wires.</p>
<p>The wire type is used simply to connect to things. A wire can only have one value, in other words it can only be connected to one thing and it will always be connected to that thing. A reg can actually drive a signal. These points are very subtle and the line between them can get blurry in some cases.</p>
<p>The only really important thing to know is that a reg can be assigned a value in an <strong>always</strong> block while wires can not (they can be read though). Any time you use always blocks you will be using reg's. If you are just connecting two signals you will be using wires.</p>
<p>Here we are declaring two 25 bit wide reg's. We are going to use these signals to create a 25 bit wide flip flop (made up of 25 1 bit flip flops). The suffixes <strong>_d</strong> and <strong>_q</strong> corresponding to the flip flop signals <strong>d</strong> and <strong>q</strong> from before. It is good practice to use this naming convention.</p>
<h3 id="combinational-always-blocks">Combinational always blocks</h3>
<pre data-linenos data-lang="verilog" style="background-color:#282828;color:#ffffff;" class="language-verilog "><code class ="language-verilog" data-lang="verilog"><table><tbody><tr><td>11</td><td><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">@(</span><span>counter_q</span><span style="color:#ed4343;">) </span><span style="font-weight:bold;color:#0abfbf;">begin
</span></td></tr><tr><td>12</td><td><span>  counter_d </span><span style="color:#ed4343;">=</span><span> counter_q </span><span style="color:#ed4343;">+ </span><span style="color:#a269dc;">1&#39;b1</span><span style="color:#ed4343;">;
</span></td></tr><tr><td>13</td><td><span style="font-weight:bold;color:#0abfbf;">end
</span></td></tr></tbody></table></code></pre>
<p>This is our first always block. Always blocks can kinda be thought of as functions that run under certain conditions. Those conditions are specified in the <strong>sensitivity list</strong>. The sensitivity list in this case is just <strong>counter_q</strong>. This is because the values this always block produces will only change when <strong>counter_q</strong> changes.</p>
<p>Since this is out <strong>combinational</strong> always block, we could have used <strong>@(*)</strong> for the sensitivity list. This says that this always block will be run whenever <strong>anything</strong> changes. The only reason not to do this is for simulations. In a simulation the always blocks are run basically as functions and limiting the sensitivity list to only the signals of interest will help reduce the time needed to run the simulation. For synthesis (the actual FPGA design) it doesn't make any difference since it will be in hardware and will just exist. Many times I just use <strong>@(*)</strong> for my sensitivity lists though.</p>
<p>The line inside the block is very important. This line says that the <strong>d</strong> signal to the flip flop will get the <strong>q</strong> value plus 1. This is very similar to our example with the flip flop and the not gate. We are making a loop.</p>
<h3 id="synchronous-always-blocks">Synchronous always blocks</h3>
<pre data-linenos data-lang="verilog" style="background-color:#282828;color:#ffffff;" class="language-verilog "><code class ="language-verilog" data-lang="verilog"><table><tbody><tr><td>15</td><td><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">@(</span><span style="font-weight:bold;color:#0abfbf;">posedge</span><span> clk</span><span style="color:#ed4343;">) </span><span style="font-weight:bold;color:#0abfbf;">begin
</span></td></tr><tr><td>16</td><td><span>  </span><span style="font-weight:bold;color:#0abfbf;">if </span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">) </span><span style="font-weight:bold;color:#0abfbf;">begin
</span></td></tr><tr><td>17</td><td><span>    counter_q </span><span style="color:#ed4343;">&lt;= </span><span style="color:#a269dc;">25&#39;b0</span><span style="color:#ed4343;">;
</span></td></tr><tr><td>18</td><td><span>  </span><span style="font-weight:bold;color:#0abfbf;">end else begin
</span></td></tr><tr><td>19</td><td><span>    counter_q </span><span style="color:#ed4343;">&lt;=</span><span> counter_d</span><span style="color:#ed4343;">;
</span></td></tr><tr><td>20</td><td><span>  </span><span style="font-weight:bold;color:#0abfbf;">end
</span></td></tr><tr><td>21</td><td><span style="font-weight:bold;color:#0abfbf;">end
</span></td></tr></tbody></table></code></pre>
<p>This block is a bit more interesting. The sensitivity list for synchronous always blocks is very important. The list uses the keyword <strong>posedge</strong>. This means that the block is only sensitive to the positive edge of the signal, in other words, a transition from a 0 to a 1. This is exactly what a flip flop's clock input is sensitive to.</p>
<p>Verilog has no direct way to create flip flops. Instead, you have to use a template, like this block, for the tools to realize that is what you wanted. This block basically just describes the function of a flip flop that has input <strong>counter_d</strong>, output <strong>counter_q</strong>, clock <strong>clk</strong>, and reset <strong>rst</strong>. </p>
<p>The if statement in the block is used to reset the flip flop when <strong>rst</strong> is 1. When <strong>rst</strong> is 0, the flip flop will copy the value of <strong>counter_d</strong> to <strong>counter_q</strong> at the positive edge of <strong>clk</strong>. </p>
<h3 id="the-counter">The counter</h3>
<p>Let's look at what this module will actually do. Right after the <strong>rst</strong> signal goes low, <strong>counter_q</strong> will be 0. That means that <strong>counter_d</strong> will be 1, since our combiational block assigns it <strong>counter_q</strong> plus 1.</p>
<p>At the next positive edge of <strong>clk</strong>, <strong>counter_q</strong> will be assigned the value of <strong>counter_d</strong>, or 1. Once <strong>counter_q</strong> is 1, <strong>counter_d</strong> must be 2! You should be able to see what will continue to happen. Each clock cycle <strong>counter_q</strong> will increase by 1. But what happens when <strong>counter_q</strong> is 25'b1111111111111111111111111 (the max value)?</p>
<p>Since we are adding a 1 bit number to a 25 bit number, the result can be up to 26 bits, but since we are storing it into a 25 bit reg we lose the last bit. That means that when <strong>counter_q</strong> is the max value, <strong>counter_d</strong> is 0 and the process starts all over again.</p>
<p>Our counter will continuously count from 0 to 33554431 (2^25 - 1). </p>
<p>How do we make an LED blink from this counter? It's simple once  you realize that for half the time the most significant bit is 1 and the other half of the time it's 0. This is because if <strong>counter_q</strong> is less than 16777216 (2^24), then the 24th but must be 0 and when it is equal or greater it must be 1. That means we can just connect the LED to the most significant bit of our counter! If you need to convince yourself this is true try writing out the binary values from 0-7 and look at how the MSB (most significant bit) changes.</p>
<p>How fast will the LED blink though? We know that the clock frequency is 50MHz, or 50,000,000 clock cycles per second. Since our counter takes 2^25 cycles to overflow we can calculate the blinker time, 2^25 / 50,000,000 or about 0.67 seconds. The LED will turn on and off every 0.67 seconds. If you wanted to make that time longer, you can just make the counter 26 bits long and the time will double to 1.34 seconds. If you wanted to make it blink faster you can make the counter shorter.</p>
<h3 id="non-blocking-assignments">Non-blocking assignments</h3>
<p>You may have noticed that in our combinational block we used <strong>=</strong> to assign <strong>counter_d</strong> a value, but in the synchronous block we used <strong>&lt;=</strong> to assign the value. The &lt;= operator is used for <strong>non-blocking assignments</strong>. All that means is all the values assigned with &lt;= get assigned immediately in parallel.</p>
<p>When you use just =, which is used for <strong>blocking assignments</strong>, that line must finish before the next one can happen.</p>
<p>This isn't too important now, just know that &lt;= is generally used in the synchronous block while = is used in the combinational block.</p>
<h3 id="instantiating-a-module">Instantiating a module</h3>
<p>Now we have to instantiate our module from the top level of our design. Open up <strong>mojo_top</strong> and edit it so it looks like the following.</p>
<pre data-lang="verilog" style="background-color:#282828;color:#ffffff;" class="language-verilog "><code class ="short language-verilog" data-lang="verilog"><span style="font-weight:bold;color:#faac1f;">module</span><span> mojo_top</span><span style="color:#ed4343;">(
</span><span>    </span><span style="color:#969696;">// 50MHz clock input
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> clk</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#969696;">// Input from reset button (active low)
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> rst_n</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#969696;">// cclk input from AVR, high when AVR is ready
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> cclk</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#969696;">// Outputs to the 8 onboard LEDs
</span><span>    </span><span style="color:#0a8dbf;">output</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">7</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span><span>led</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#969696;">// AVR SPI connections
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> spi_miso</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> spi_ss</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> spi_mosi</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> spi_sck</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#969696;">// AVR ADC channel select
</span><span>    </span><span style="color:#0a8dbf;">output </span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">3</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">]</span><span> spi_channel</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#969696;">// Serial connections
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> avr_tx</span><span style="color:#ed4343;">, </span><span style="color:#969696;">// AVR Tx =&gt; FPGA Rx
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> avr_rx</span><span style="color:#ed4343;">, </span><span style="color:#969696;">// AVR Rx =&gt; FPGA Tx
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> avr_rx_busy </span><span style="color:#969696;">// AVR Rx buffer full
</span><span>  </span><span style="color:#ed4343;">);
</span><span> 
</span><span>  </span><span style="color:#0a8dbf;">wire</span><span> rst </span><span style="color:#ed4343;">= ~</span><span>rst_n</span><span style="color:#ed4343;">; </span><span style="color:#969696;">// make reset active high
</span><span> 
</span><span>  </span><span style="color:#969696;">// these signals should be high-z when not used
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">assign</span><span> spi_miso </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">1&#39;bz</span><span style="color:#ed4343;">;
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">assign</span><span> avr_rx </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">1&#39;bz</span><span style="color:#ed4343;">;
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">assign</span><span> spi_channel </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">4&#39;bzzzz</span><span style="color:#ed4343;">;
</span><span> 
</span><span>  </span><span style="font-weight:bold;color:#0abfbf;">assign</span><span> led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">7</span><span style="color:#ed4343;">:</span><span style="color:#a269dc;">1</span><span style="color:#ed4343;">] = </span><span style="color:#a269dc;">7&#39;b0</span><span style="color:#ed4343;">;
</span><span> 
</span><span>  blinker awesome_blinker </span><span style="color:#ed4343;">(
</span><span>    .clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">),
</span><span>    .rst</span><span style="color:#ed4343;">(</span><span>rst</span><span style="color:#ed4343;">),
</span><span>    .blink</span><span style="color:#ed4343;">(</span><span>led</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">0</span><span style="color:#ed4343;">])
</span><span>  </span><span style="color:#ed4343;">);
</span><span> 
</span><span style="font-weight:bold;color:#faac1f;">endmodule
</span></code></pre>
<p>You can see where our blinker is being instantiated at line 32. The first line tells what module we are instantiating (blinker) and what we want to name this instance of it (awesome_blinker). The rest of the code is used to connect the inputs and outputs of our module. The module signal name is the first part after the . and the signal to connect it to is in the ().</p>
<p>In this case we just connect the clock and reset lines and the output to one of the LEDs.</p>
<p>You should now be able to synthesize your design and load it onto the Mojo to see an LED blink about 2x per second.</p>

    </div>
    

    <footer class="post-footer">
        

        
        



<nav class="paginav">
    
        
        <a class="prev" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;archive&#x2F;verilog&#x2F;mojo&#x2F;creating-an-ise-project&#x2F;">
            <span class="title">« Prev</span>
            <br>
            <span>Creating an ISE Project</span>
        </a>
        
        
        <a class="next" href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials&#x2F;archive&#x2F;verilog&#x2F;mojo&#x2F;pulse-width-modulation&#x2F;">
            <span class="title">Next »</span>
            <br>
            <span>Pulse Width Modulation</span>
        </a>
        
    
</nav>


        
        
    </footer>

</article>

    </main>
    
    <footer class="footer">
    <div>
        <div class="social-icons">
    
    <a href="https:&#x2F;&#x2F;github.com&#x2F;alchitry" target="_blank" rel="noopener noreferrer me" title="GitHub">
        

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>


    </a>
    
    <a href="https:&#x2F;&#x2F;youtube.com&#x2F;c&#x2F;alchitry" target="_blank" rel="noopener noreferrer me" title="YouTube">
        

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z">
    </path>
    <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
</svg>


    </a>
    
    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;atom.xml" target="_blank" rel="noopener noreferrer me" title="RSS">
        

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>


    </a>
    
</div>

        <span>&copy; 2026 <a href="https:&#x2F;&#x2F;alchitry.com">Alchitry</a></span>
    </div>
</footer>


<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="#e3e3e3"><path d="M440-320h80v-168l64 64 56-56-160-160-160 160 56 56 64-64v168Zm40 240q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>
</a>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>


<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>


<script>
    /* Open */
    function openNav() {
        document.getElementById("overlayNav").style.display = "block";
    }

    /* Close */
    function closeNav() {
        document.getElementById("overlayNav").style.display = "none";
    }
</script>



<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            let codeText = '';

            // 1. Check if the codeblock contains a table (Line Numbers present)
            const tableRows = codeblock.querySelectorAll('table tr');

            if (tableRows.length > 0) {
                const lines = [];
                tableRows.forEach(row => {
                    // The actual code is in the last TD
                    const codeCell = row.lastElementChild;
                    if (codeCell) {
                        let cellText = codeCell.textContent;

                        if (cellText.endsWith('\n')) {
                            cellText = cellText.slice(0, -1);
                        }

                        lines.push(cellText);
                    }
                });
                codeText = lines.join('\n');
            } else {
                // 2. No table, use standard text extraction
                codeText = codeblock.textContent;
            }

            // 3. Copy the cleaned text to clipboard
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeText);
                copyingDone();
                return;
            }

            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = codeText;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {
                console.error('Copy failed', e);
            }
            document.body.removeChild(textArea);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            // td containing LineNos
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            // table containing LineNos and code
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            // code blocks not having highlight as parent class
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript" src="https://alchitry.com/elasticlunr.min.js"></script>
<script type="text/javascript" src="https://alchitry.com/search.js"></script>
<script type="module" src="https://alchitry.com/table-toggles.js"></script>
    
</body>
</html>
