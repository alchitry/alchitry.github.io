<!DOCTYPE html>
<html lang="en" dir="auto">
<head>
    
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Lucid V2 - Update 2 - Test Benches</title>


<meta name="keywords" content="keyword1, keyword2, keyword3">



<meta name="description" content="">



<meta name="author" content="Justin Rajewski">


<link rel="canonical" href="https:&#x2F;&#x2F;alchitry.com&#x2F;news&#x2F;lucid-v2-update-2&#x2F;">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<script type="importmap">
    {
      "imports": {
        "@material/web/": "https://esm.run/@material/web/"
      }
    }
</script>
<script type="module">
    import '@material/web/all.js';
    import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
</script>

<link rel="stylesheet" href="https://alchitry.com/styles.css">
<link rel="stylesheet" href="https://alchitry.com/override.css">

<link rel="icon" href="https://alchitry.com/favicon.svg" type="image/svg+xml">
<link rel="icon" type="image/png" sizes="16x16" href="https://alchitry.com/favicon_16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://alchitry.com/favicon_32.png">
<link rel="apple-touch-icon" href="https://alchitry.com/apple-touch-icon.png"><!-- 180×180 -->
<meta name="theme-color" content="#333333">


<link rel="alternate" type="application/atom+xml" title="RSS" href="https://alchitry.com/atom.xml">


<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }
    </style>
    
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
    
</noscript>



    
</head>
<body class=" dark" id="top">
    
    
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0"/>

<header class="header">

    <nav class="nav">
        <div class="logo">
            <a href="https:&#x2F;&#x2F;alchitry.com" accesskey="h" title="Alchitry (Alt + H)"><img src="https://alchitry.com/alchitry.svg"
                                                         alt="Alchitry"
                                                         aria-label="Alchitry">
            </a>
        </div>
        
        <div id="nav-search">
            <ul id="menu" class="desktop-nav">
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;shop.alchitry.com&#x2F;collections&#x2F;products" title="Boards">
                        <span>Boards</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;news" title="News">
                        <span>News</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials" title="Tutorials">
                        <span>Tutorials</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;alchitry-labs" title="Alchitry Labs">
                        <span>Alchitry Labs</span>
                        
                    </a>
                </li>
                
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;forum.alchitry.com" title="Forum">
                        <span>Forum</span>
                        
                    </a>
                </li>
                
            </ul>
            <div class="search-container">
                <input class="search" type="search" placeholder="Search" autocomplete="off">
                <span class="material-symbols-outlined search-icon">search</span>

                <div class="search-results">
                    <div class="search-results__items"></div>
                </div>
            </div>
        </div>
        <div id="overlayNavOpen">
            <span onclick="openNav()" class="material-symbols-outlined">menu</span>
        </div>
        
    </nav>
</header>


<div id="overlayNav" class="overlay">
    <div class="overlay-header">
        <div class="search-container">
            <input class="search" type="search" placeholder="Search" autocomplete="off">
            <span class="material-symbols-outlined search-icon">search</span>

            <div class="search-results">
                <div class="search-results__items"></div>
            </div>
        </div>
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    </div>

    <div class="overlay-content">
        
        
        
        <a href="https:&#x2F;&#x2F;shop.alchitry.com&#x2F;collections&#x2F;products" title="Boards">
            <span>Boards</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;news" title="News">
            <span>News</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;tutorials" title="Tutorials">
            <span>Tutorials</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;alchitry-labs" title="Alchitry Labs">
            <span>Alchitry Labs</span>
            
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;forum.alchitry.com" title="Forum">
            <span>Forum</span>
            
        </a>
        
    </div>
</div>

    
    <main class="main">
        
<article class="post-single">
    <header class="post-header">
        <div class="breadcrumbs">
            
            <div class="breadcrumb-container">
                <a class="breadcrumb-path" href="/">Home</a>
                
                
                
                
                
                <span class="breadcrumb-separator">»</span>
                
                <a class="breadcrumb-path" href="https:&#x2F;&#x2F;alchitry.com&#x2F;news&#x2F;">News</a>
                
                <span class="breadcrumb-separator">»</span>
                <a class="breadcrumb-path active" href="https:&#x2F;&#x2F;alchitry.com&#x2F;news&#x2F;lucid-v2-update-2&#x2F;">Lucid V2 - Update 2 - Test Benches</a>
            </div>
            
        </div>
        <h1 class="post-title">Lucid V2 - Update 2 - Test Benches</h1>
        
        
        <div class="post-meta">
            
















<span>2023-06-01</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Justin Rajewski

            &nbsp;|&nbsp;&nbsp;<a href="https:&#x2F;&#x2F;github.com&#x2F;alchitry&#x2F;alchitry.github.io&#x2F;tree&#x2F;master/content/news&#x2F;lucid-v2-update-2.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

        </div>
        
    </header>

    
    

<div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner">
            <ul>
                
                <li>
                    <a href="#test-bench-example" aria-label="Test Bench Example">Test Bench Example</a>
                    
                    <ul>
                    
                        <li>
                            <a href="#test-bench-functions" aria-label="Test Bench Functions">Test Bench Functions</a>
                            
                        </li>
                    
                    </ul>
                    
                </li>
                
                <li>
                    <a href="#next-step" aria-label="Next Step">Next Step</a>
                    
                </li>
                
            </ul>
        </div>
    </details>
</div>


    

    
    <div class="post-content">
        <p>Test benches are here!</p>
<p>I just pushed a working draft of the test bench code that has the necessities for writing quick tests for you modules!</p>
<h2 id="test-bench-example">Test Bench Example<a class="anchor" aria-hidden="true" href="#test-bench-example" hidden="">#</a>
</h2>
<p>Take a look at this revolutionary counter module I created. </p>
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#faac1f;">module</span><span> counter </span><span style="color:#ed4343;">(
</span><span>    </span><span style="color:#0a8dbf;">input</span><span> clk</span><span style="color:#ed4343;">,
</span><span>    </span><span style="color:#0a8dbf;">output</span><span> count</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">]
</span><span style="color:#ed4343;">) {
</span><span>    </span><span style="color:#0a8dbf;">dff</span><span> counter</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">8</span><span style="color:#ed4343;">] (</span><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">))
</span><span>
</span><span>    </span><span style="font-weight:bold;color:#0abfbf;">always </span><span style="color:#ed4343;">{
</span><span>        counter.d </span><span style="color:#ed4343;">=</span><span> counter.q </span><span style="color:#ed4343;">+ </span><span style="color:#a269dc;">1
</span><span>        count </span><span style="color:#ed4343;">=</span><span> counter.q
</span><span>    </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
<p>I designed it so that the output <code class ="language-lucid" data-lang="lucid"><span>count</span></code> will increment by one on every rising edge of the <code class ="language-lucid" data-lang="lucid"><span>clk</span></code> input. However, does 
it actually work?!? There's no way to know. Oh wait, we could test it.</p>
<p>Here is my test bench that does just that.</p>
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span>testBench myTestBench </span><span style="color:#ed4343;">{
</span><span>    </span><span style="color:#0a8dbf;">sig</span><span> clk </span><span style="color:#969696;">// signal to use as my clock
</span><span>    
</span><span>    counter dut </span><span style="color:#ed4343;">(</span><span>.clk</span><span style="color:#ed4343;">(</span><span>clk</span><span style="color:#ed4343;">)) </span><span style="color:#969696;">// device under test
</span><span>    
</span><span>    </span><span style="font-weight:bold;color:#0abfbf;">fun</span><span> tickClock</span><span style="color:#ed4343;">() {
</span><span>        clk </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">1
</span><span>        </span><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()
</span><span>        clk </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">0
</span><span>        </span><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()
</span><span>    </span><span style="color:#ed4343;">}
</span><span>    
</span><span>    </span><span style="font-weight:bold;color:#0abfbf;">test</span><span> simpleTest </span><span style="color:#ed4343;">{
</span><span>        clk </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">0 </span><span style="color:#969696;">// initialize the clock
</span><span>        </span><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()
</span><span>        
</span><span>        </span><span style="font-weight:bold;color:#0abfbf;">repeat</span><span style="color:#ed4343;">(</span><span style="color:#a269dc;">100</span><span style="color:#ed4343;">,</span><span> i</span><span style="color:#ed4343;">) {
</span><span>            </span><span style="color:#1bddaf;">$print</span><span style="color:#ed4343;">(</span><span>dut.count</span><span style="color:#ed4343;">)
</span><span>            </span><span style="color:#1bddaf;">$assert</span><span style="color:#ed4343;">(</span><span>dut.count </span><span style="color:#ed4343;">==</span><span> i</span><span style="color:#ed4343;">)
</span><span>            </span><span style="color:#1bddaf;">$tickClock</span><span style="color:#ed4343;">()
</span><span>        </span><span style="color:#ed4343;">}
</span><span>        
</span><span>        </span><span style="color:#1bddaf;">$assert</span><span style="color:#ed4343;">(</span><span>dut.count </span><span style="color:#ed4343;">== </span><span style="color:#a269dc;">100</span><span style="color:#ed4343;">)
</span><span>    </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
<p>The insides of a <code class ="language-lucid" data-lang="lucid"><span>testBench</span></code> are very similar to a <code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#faac1f;">module</span></code> with a couple of key differences. There are no ports
or parameters and instead of <code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">always</span></code> blocks you use <code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">test</span></code> and <code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">fun</span></code> blocks.</p>
<p>On line 2, we create a signal named <code class ="language-lucid" data-lang="lucid"><span>clk</span></code> that will act as our clock.</p>
<p>On line 4, we instantiate the device under test or &quot;dut&quot;. It is convention to call the module being tested &quot;dut&quot; but 
there is nothing special about the name.</p>
<p>Next, we have our function declaration. Functions have the same properties as tests, but they aren't run directly. 
Instead, functions are little pieces of helper code that can be called from tests.</p>
<p>Here I defined the very common function of toggling the clock and called it <code class ="language-lucid" data-lang="lucid"><span>tickClock</span></code>. This function doesn't have any
parameters, but it could.</p>
<p>For example, we could give it a parameter to repeat a specified number of times.</p>
<pre data-lang="lucid" style="background-color:#282828;color:#ffffff;" class="language-lucid "><code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">fun</span><span> tickClock</span><span style="color:#ed4343;">(</span><span>times</span><span style="color:#ed4343;">[</span><span style="color:#a269dc;">32</span><span style="color:#ed4343;">]) {
</span><span>    </span><span style="font-weight:bold;color:#0abfbf;">repeat</span><span style="color:#ed4343;">(</span><span>times</span><span style="color:#ed4343;">) {
</span><span>        clk </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">1
</span><span>        </span><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()
</span><span>        clk </span><span style="color:#ed4343;">= </span><span style="color:#a269dc;">0
</span><span>        </span><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()
</span><span>    </span><span style="color:#ed4343;">}
</span><span style="color:#ed4343;">}
</span></code></pre>
<p>Function arguments act the same as module inputs and can be multidimensional arrays or structs.</p>
<h3 id="test-bench-functions">Test Bench Functions<a class="anchor" aria-hidden="true" href="#test-bench-functions" hidden="">#</a>
</h3>
<p>Before we move on, let me quickly go over the couple of test bench specific functions that I'm using.</p>
<p>The function <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()</span></code> is at the very core of the simulation. It initiates a simulation tick. So what is a simulation
tick? This is when the simulator publishes all signal changes and recalculates the outputs for all the pieces in the 
design whose input signals changed. Those output changes then trigger other updates if they are used as inputs. This 
continues until the results of everything stabilize.</p>
<p>The only time it won't stabilize is if you have some kind of dependency loop like <code class ="language-lucid" data-lang="lucid"><span>a </span><span style="color:#ed4343;">=</span><span> b</span></code> and <code class ="language-lucid" data-lang="lucid"><span>b </span><span style="color:#ed4343;">= ~</span><span>a</span></code>. In this case, 
the simulator will quit after 1000 iterations. I chose this number as a seemingly nice upper bound, but it may change if
I find designs often need more or fewer iterations. A loop like this would result in faulty hardware, and anything 
requiring too many iterations to resolve would likely be too complicated to do in a single real clock cycle.</p>
<p>So back to the test bench. Before we call <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()</span></code>, first we need to set a value to all signals we are using. Signals 
default to having a <code class ="language-lucid" data-lang="lucid"><span style="color:#a269dc;">bx</span></code> value so bad things will happen if we call <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()</span></code> before setting a real value. By bad things,
I mean that <code class ="language-lucid" data-lang="lucid"><span style="color:#a269dc;">bx</span></code> value will propagate throughout the design contaminating our counter.</p>
<p>With <code class ="language-lucid" data-lang="lucid"><span>clk</span></code> set to 0, we call <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()</span></code> to initialize the design.</p>
<p>Next, we hit a <code class ="language-lucid" data-lang="lucid"><span style="font-weight:bold;color:#0abfbf;">repeat</span></code> block that will repeat its contents 100 times and use the signal <code class ="language-lucid" data-lang="lucid"><span>i</span></code> as the iteration index.</p>
<p>The first line in the loop prints the value of <code class ="language-lucid" data-lang="lucid"><span>dut.count</span></code> using the <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$print</span><span style="color:#ed4343;">()</span></code> function. This function takes one
argument, the value to print. It currently outputs the value in the format <code class ="language-lucid" data-lang="lucid"><span>dut.count </span><span style="color:#ed4343;">= {</span><span style="color:#a269dc;">00011100</span><span style="color:#ed4343;">} : </span><span style="color:#a269dc;">28</span></code> where the value
is shown in its binary form as well as its decimal value (if it has one).</p>
<p>The next line uses the <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$assert</span><span style="color:#ed4343;">()</span></code> function to check that the value of the counter matches the loop iteration we are on.
The argument to <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$assert</span><span style="color:#ed4343;">()</span></code> can be anything, and it is treated as a boolean. That means if it is non-zero, nothing 
happens, but if it is zero, the simulation is aborted and the <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$assert</span><span style="color:#ed4343;">()</span></code> that caused it is called out.</p>
<p>This is very useful for checking values quickly without having to look back through the simulation manually to see if 
values make sense.</p>
<p>The last line in the loop is the call to the function <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$tickClock</span><span style="color:#ed4343;">()</span></code> that we already defined.</p>
<p>Finally, we end our test by checking that the counter output is 100 after the 100 cycles.</p>
<p>This example is from one of the tests and can be found in the 
<a href="https://github.com/alchitry/LucidParserV2/blob/9795d9dcea1a769be7567025b15607549c36edc3/src/test/kotlin/TestBenchTests.kt#L45">repo here</a>.</p>
<h2 id="next-step">Next Step<a class="anchor" aria-hidden="true" href="#next-step" hidden="">#</a>
</h2>
<p>The next step is to add snapshots of the entire design every time <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$tick</span><span style="color:#ed4343;">()</span></code> is called. This will allow for the 
simulation results to be shown after it is run. Currently, it just runs discarding all intermediate values.</p>
<p>I also plan to have a <code class ="language-lucid" data-lang="lucid"><span style="color:#1bddaf;">$silentTick</span><span style="color:#ed4343;">()</span></code> or similarly named function that does a tick without taking a snapshot. This way
you can use that when making the clock fall for most designs and avoid the overhead of an entire snapshot.</p>
<p>As before, there is a <a href="https://github.com/alchitry/LucidParserV2/discussions">discussion page</a> setup as part of the repo
where you can let me know your thoughts.</p>

    </div>
    

    <footer class="post-footer">
        

        
        



<nav class="paginav">
    
        
        <a class="prev" href="https:&#x2F;&#x2F;alchitry.com&#x2F;news&#x2F;lucid-v2-update-1&#x2F;">
            <span class="title">« Prev</span>
            <br>
            <span>Lucid V2 - Update 1</span>
        </a>
        
        
        <a class="next" href="https:&#x2F;&#x2F;alchitry.com&#x2F;news&#x2F;alchitry-labs-v2&#x2F;">
            <span class="title">Next »</span>
            <br>
            <span>Alchitry Labs V2</span>
        </a>
        
    
</nav>


        
        
    </footer>

</article>

    </main>
    
    <footer class="footer">
    <div>
        <div class="social-icons">
    
    <a href="https:&#x2F;&#x2F;github.com&#x2F;alchitry" target="_blank" rel="noopener noreferrer me" title="GitHub">
        

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>


    </a>
    
    <a href="https:&#x2F;&#x2F;youtube.com&#x2F;c&#x2F;alchitry" target="_blank" rel="noopener noreferrer me" title="YouTube">
        

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z">
    </path>
    <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
</svg>


    </a>
    
    <a href="https:&#x2F;&#x2F;alchitry.com&#x2F;atom.xml" target="_blank" rel="noopener noreferrer me" title="RSS">
        

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>


    </a>
    
</div>

        <span>&copy; 2026 <a href="https:&#x2F;&#x2F;alchitry.com">Alchitry</a></span>
    </div>
</footer>


<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="#e3e3e3"><path d="M440-320h80v-168l64 64 56-56-160-160-160 160 56 56 64-64v168Zm40 240q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>
</a>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>


<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>


<script>
    /* Open */
    function openNav() {
        document.getElementById("overlayNav").style.display = "block";
    }

    /* Close */
    function closeNav() {
        document.getElementById("overlayNav").style.display = "none";
    }
</script>



<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            let codeText = '';

            // 1. Check if the codeblock contains a table (Line Numbers present)
            const tableRows = codeblock.querySelectorAll('table tr');

            if (tableRows.length > 0) {
                const lines = [];
                tableRows.forEach(row => {
                    // The actual code is in the last TD
                    const codeCell = row.lastElementChild;
                    if (codeCell) {
                        let cellText = codeCell.textContent;

                        if (cellText.endsWith('\n')) {
                            cellText = cellText.slice(0, -1);
                        }

                        lines.push(cellText);
                    }
                });
                codeText = lines.join('\n');
            } else {
                // 2. No table, use standard text extraction
                codeText = codeblock.textContent;
            }

            // 3. Copy the cleaned text to clipboard
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeText);
                copyingDone();
                return;
            }

            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = codeText;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {
                console.error('Copy failed', e);
            }
            document.body.removeChild(textArea);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            // td containing LineNos
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            // table containing LineNos and code
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            // code blocks not having highlight as parent class
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript" src="https://alchitry.com/elasticlunr.min.js"></script>
<script type="text/javascript" src="https://alchitry.com/search.js"></script>
<script type="module" src="https://alchitry.com/table-toggles.js"></script>
    
</body>
</html>
